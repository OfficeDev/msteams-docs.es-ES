### YamlMime:Tutorial
title: Invocar módulos de tareas desde Microsoft Teams
metadata:
  title: Invocar módulos de tareas desde Microsoft Teams
  description: En este tutorial, aprenderás a configurar Teams de tareas.
  audience: Developer
  level: Beginner
  ms.date: 23/02/2022
  ms.topic: interactive-tutorial
  nextTutorialHref: task-modules-and-cards/task-modules/task-modules-bots.md
  nextTutorialTitle: Leer más sobre módulos de tareas de bots
  ms.custom: mvc
  ms.localizationpriority: High
  ms.openlocfilehash: 4d2e7c2f1da2c8a0d9f6135c9aaef5ae01f8cec8
  ms.sourcegitcommit: 3dc9b539c6f7fbfb844c47a78e3b4d2200dabdad
  ms.translationtype: MT
  ms.contentlocale: es-ES
  ms.lasthandoff: 03/31/2022
  ms.locfileid: "64571511"
items:
- durationInMinutes: 1
  content: >
    Puede invocar módulos de tareas desde Teams bots mediante tarjetas adaptables o tarjetas de Bot Framework.


    **Características clave de los módulos de tareas**


    * Mejore la experiencia del usuario evitando varios pasos.

    * Ayudar a los usuarios a realizar un seguimiento del estado del bot.

    * Recupere la entrada del usuario y muestre el contenido de la página web personalizada.


    Esta guía paso a paso le ayuda a crear un bot de Azure de ejemplo para invocar Teams módulo de tareas. Verá el resultado siguiente:

     ![Módulo de tareas](~/assets/images/Teams-task-module/final_image.png)
- title: Requisitos previos
  durationInMinutes: 1
  content: "Asegúrese de instalar las siguientes herramientas y configurar el entorno de desarrollo: \n\n* [Microsoft Teams](https://teams.microsoft.com/) con una cuenta válida\n* [SDK de .NET Core](https://dotnet.microsoft.com/download) versión 3.1\n* [Versión más reciente de Microsoft Visual Studio](https://visualstudio.microsoft.com/downloads/)\n* [versión más reciente de ngrok](https://ngrok.com/download) o cualquier solución de túnel equivalente\n\n  > [!NOTE]\n  > Después de descargar ngrok, regístrate e instala [authtoken](https://ngrok.com/download).\n"
- title: Configurar entorno local
  durationInMinutes: 1
  content: "Clone `BotBuilder-Samples` el repositorio en el repositorio local GitHub:  \n\n 1. Abra [Ejemplos de BotBuilder](https://github.com/microsoft/BotBuilder-Samples).\n 1. Seleccione **Código**.\n 1. En el menú desplegable, selecciona **Abrir con GitHub escritorio**.\n\n    ![Repositorio de clones](~/assets/images/Teams-task-module/clonerepository.png)\n\n 1. Seleccione **Clonar**. \n"
- title: Crear y registrar el bot en Azure AD portal
  durationInMinutes: 5
  content: "Para crear y registrar el bot en Microsoft Azure Active Directory (Azure AD), cree un túnel con ngrok y agregue un extremo de mensajería, siga estos pasos:\n\n* Cree el recurso Bot de Azure para registrar el bot con Azure Bot Service.\n* Cree un secreto de cliente para habilitar la autenticación sso del bot.\n* Agregue Teams para implementar el bot en un canal Teams.\n* Use ngrok para crear un túnel a los puntos de conexión del servidor web.\n* Agregue el punto de conexión de mensajería al túnel ngrok que creó.\n\n**Para crear un recurso bot de Azure**\n\n1. Vaya al [portal de Microsoft Azure web](https://portal.azure.com/).\n1. Elija **Crear un recurso**.\n1. En el cuadro de búsqueda, escriba **Bot de Azure**.\n1. Seleccione **Entrar**.\n1. Seleccione **Bot de Azure**.\n\n     ![Crear tarjeta de bot de Azure](~/assets/images/bots/createazurebot.png)\n\n1. Seleccione **Crear**.\n1. Escriba el nombre del controlador del bot necesario en **el controlador bot**.\n1. Selecciona tu **suscripción** en la lista desplegable.\n1. Selecciona el **grupo De recursos** de la lista desplegable. \n\n    ![Seleccionar bot de Azure de recursos](~/assets/images/Teams-task-module/review-plus-create.png) \n\n   También puede crear un nuevo grupo de recursos (seleccione Crear **nuevo** > nombre de recurso > seleccione **Aceptar**).\n\n1. Si ha creado un nuevo grupo de recursos, seleccione la ubicación necesaria en **la lista desplegable Nueva ubicación de grupo de** recursos.\n\n    ![Nueva ubicación del grupo de recursos](~/assets/images/meetings-side-panel/newresource.png)\n\n1. En la **sección Id. de aplicación de Microsoft** , está seleccionada de forma predeterminada **Crear nuevo identificador de aplicación de Microsoft** . \n\n   Puedes seleccionar Usar el registro de la aplicación **existente** y escribir **Id** . de aplicación existente y Contraseña de aplicación **existente, o** **bien seleccionar Crear nuevo identificador de aplicación de Microsoft**.\n\n   > [!NOTE]\n   > No puedes crear más de un bot con el mismo **identificador de aplicación de Microsoft**.\n\n1. Seleccione **MultiTenant en** Tipo de bot.\n\n    ![Id. de aplicación de Microsoft](~/assets/images/Teams-task-module/config.png)\n\n1. Seleccione **Revisar y crear**.\n\n    ![Crear id. de aplicación de Microsoft](~/assets/images/meeting-token-generator/meeting-token-generator-appidcreate.png)\n\n1. Si la validación pasa, seleccione **Crear**. \n\n    El servicio de bots tarda unos minutos en aprovisionarse. \n\n1. Seleccione **Ir a recursos**. \n\n    ![Implementar aplicación](~/assets/images/Teams-task-module/botdeployment.png)\n\n    Se crea el bot de Azure.\n\n    ![Recurso de bot de Azure creado](~/assets/images/Teams-task-module/bot-page.png)\n\n**Para crear un secreto de cliente**\n\n  Realice los pasos siguientes si ha creado un nuevo **identificador de aplicación de Microsoft**:\n\n1. En el panel izquierdo, seleccione **Configuración**. \n\n   > [!TIP]\n   > Guarde el **id. de la aplicación de Microsoft** **o el id. de cliente** para referencia futura.\n\n1. Junto a **Id. de aplicación de Microsoft**, selecciona **Administrar**.\n\n1. En la **sección Secretos de** cliente, seleccione **Nuevo secreto de cliente**. \n\n    ![Nuevo secreto de cliente](~/assets/images/meetings-side-panel/newclientsecret.png)\n\n   Aparecerá **la ventana Agregar un secreto de** cliente.  \n\n1. Escriba **Descripción**.\n\n1. Seleccione **Agregar**.\n\n    ![Agregar secreto de cliente a la aplicación](~/assets/images/Teams-task-module/clientsecret.png)\n\n1. En la **columna** Valor, seleccione **Copiar en el Portapapeles**.\n\n     ![Valor del secreto de cliente](~/assets/images/Teams-task-module/clientvalue.png)\n   \n   > [!TIP]\n   > Guarde el **valor secretos de** cliente o la contraseña de la aplicación para su referencia futura.\n\n**Para agregar el Teams canal**\n\n1. Seleccione **Inicio**.\n\n    ![Página principal](~/assets/images/Teams-task-module/gotohome.png)\n\n1. Seleccione el bot en **Recursos recientes**.\n\n1. Seleccione **Canales** en el panel izquierdo. \n\n1. Seleccione **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>.\n\n1. Active la casilla para aceptar los **Términos de servicio**.\n\n1. Seleccione **Aceptar**.\n\n      ![Términos de servicio](~/assets/images/meetings-side-panel/terms.png)\n\n1. Haga clic en **Guardar**.\n\n      ![Seleccione Teams](~/assets/images/Teams-task-module/configteams.png)   \n\n**Para crear un túnel para el servidor web local**\n\nUse ngrok para crear un túnel para los puntos de conexión HTTPS del servidor web que se ejecuta localmente. Ejecute el siguiente comando en ngrok:\n\n ```bash\n ngrok http -host-header=rewrite 3978\n ```\n\n> [!TIP]\n> Si encuentras **ERR_NGROK_4018**, sigue los pasos proporcionados en el símbolo del sistema para registrarte y autenticar ngrok. A continuación, ejecute el comando `ngrok http -host-header=localhost 3978`.\n\n**Para agregar punto de conexión de mensajería**\n\n1. Desde ngrok, copie la dirección URL HTTPS (https a io).\n\n    ![ngrok DIRECCIÓN URL HTTPS](~/assets/images/Teams-task-module/ngrok.png)\n\n    > [!NOTE]\n    > La dirección URL HTTPS de su ngrok es su nombre de dominio completo.\n    > Se `WebAppDomain` trata de un nombre de dominio completo que no incluye `https://` en él.\n\n1. En **Configuración** para el bot de Azure que creó, seleccione **Configuración**.\n\n1. En **el extremo de** mensajería, use la dirección URL HTTPS disponible desde ngrok y al final de la dirección URL agregue **/api/messages**.\n\n    ![Extremo de mensajería](~/assets/images/Teams-task-module/messaging-endpoint.png)\n\n1. Seleccione **Aplicar**.\n\n    Ha configurado correctamente un bot en Azure Bot Service.\n"
- title: Actualizar el registro Azure AD aplicación
  durationInMinutes: 1
  content: "1. Vaya a [Azure Portal](https://portal.azure.com/).\n\n1. Seleccione **Azure Active Directory**.\n\n1. En el panel de navegación izquierdo, seleccione **Registros de aplicaciones**.\n\n1. Seleccione el bot.\n\n   ![Registro de la aplicación](~/assets/images/Teams-task-module/appregister.png)\n\n1. Seleccione **Administrar**.\n\n1. En el panel izquierdo, seleccione **Exponer** **una API**.\n\n1. Seleccione **Establecer**.\n\n   ![Exponer una API](~/assets/images/Teams-task-module/exposeanapi.png)\n\n1. Establezca el **URI de id.** de aplicación en forma de `api://{AppID}`.\n\n   ![Establecer vínculo](~/assets/images/Teams-task-module/setlink.png)\n\n1. Inserte el `WebAppDomain` valor entre `api://` y `/{AppID}`.</br>\n    `api://d4b8****.ngrok.io/{AppID}`</br>\n    \n   La siguiente imagen muestra el nombre de dominio:\n    \n    ![URI de id. de aplicación](~/assets/images/Teams-task-module/appIDuri.png)\n\n    > [!NOTE]\n    > Si usa un servicio de túnel como ngrok, asegúrese de actualizar el valor siempre que cambie el subdominio ngrok.\n    > `For example: api://f631****.ngrok.io/92c11075-c629-4a1e-ab58-02b4fd4204c2`, donde `f631****.ngrok.io` está el nuevo nombre del subdominio ngrok.\n\n1. Seleccione **Agregar un ámbito**. \n\n   ![Seleccionar ámbito](~/assets/images/meetings-side-panel/selectscope.png)\n\n1. En el panel que aparece, escriba `access_as_user` como nombre **de ámbito**.\n\n1. Establezca **Quién puede dar su consentimiento?** en `Admins and users`.\n\n1. Para configurar los mensajes de consentimiento de administrador y usuario con los `access_as_user` valores adecuados para el ámbito, proporcione la siguiente información en los campos:</br>\n\n     * Escriba `Teams can access the user’s profile` como **Nombre para mostrar del consentimiento de administrador**.\n\n     * Escriba `Allows Teams to call the app’s web APIs as the current user` como **Descripción del consentimiento de administrador**.\n\n     * Escriba `Teams can access the user profile and make requests on the user’s behalf` como **Nombre para mostrar del consentimiento de usuario**.\n\n     * Escriba `Enable Teams to call this app’s APIs with the same rights as the user` como **Descripción del consentimiento del usuario**.\n\n1. Asegúrese de que **Estado** se establece en **Habilitado**.\n\n1. Seleccione **Agregar ámbito para** guardar.\n\n    ![Agregar un ámbito](~/assets/images/Teams-task-module/addascope.png)\n\n    > [!NOTE]\n    > El **nombre del ámbito** debe coincidir con el URI **del identificador de** aplicación con `/access_as_user` anexado al final.</br>\n       `api://d4b8****.ngrok.io/00000000-0000-0000-0000-000000000000/access_as_user`\n\n    ![Scopes](~/assets/images/Teams-task-module/scopes.png) \n\n1. En la sección **Aplicaciones cliente autorizadas**, identifique las aplicaciones que quiere autorizar en la aplicación web de la aplicación. \n\n1. Seleccione **Agregar una aplicación cliente**. \n\n    ![Seleccionar aplicación cliente](~/assets/images/meetings-side-panel/selectclientapp.png) \n\n1. Escriba **Id. de** cliente: `1fec8e78-bce4-4aaf-ab1b-5451cc387264` para Teams móvil o de escritorio. \n\n    ![Agregar aplicación cliente 1](~/assets/images/meetings-side-panel/addclientapplication1.png) \n\n   Escriba **Id. de** cliente: `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` para Teams aplicación web.\n\n    ![Agregar aplicación cliente 2](~/assets/images/meetings-side-panel/addclientapplication2.png) \n\n1. Seleccione **Ámbitos autorizados**.\n\n    ![Agregar aplicación cliente 2](~/assets/images/Teams-task-module/authorizedscope.png) \n\n   En la siguiente imagen se muestran los IDs de cliente:\n\n    ![Aplicaciones cliente](~/assets/images/meetings-side-panel/clientapps.png) \n\n1. En el panel izquierdo, seleccione **Permisos de API**. \n\n   > [!NOTE]\n   > Los usuarios deben dar su consentimiento a los permisos de la API solo si la aplicación Azure AD está registrada en un inquilino diferente.\n\n1. Seleccione **Agregar un permiso**\n\n    ![Agregar permiso](~/assets/images/meetings-side-panel/addpermission.png)\n\n1. Seleccione **Microsoft Graph**.\n\n1. Seleccione **Permisos delegados**\n\n1. Seleccione los siguientes permisos:</br>\n     * **email**\n     * **offline_access**\n     * **OpenId**\n     * **profile**\n      * **User.Read**\n\n1. Seleccione **Agregar permisos**.\n\n     ![Otros permisos](~/assets/images/meetings-side-panel/other-permissions.png)\n\n1. En el panel izquierdo, seleccione **Autenticación** para establecer un URI de redireccionamiento. \n\n   > [!NOTE]\n   > Si a una aplicación no se le concede el consentimiento de administrador de TI, los usuarios deben proporcionar su consentimiento la primera vez que usen una aplicación.\n           \n     1. Seleccione **Agregar una plataforma**.\n     1. Seleccione **Web**.\n\n        ![Web](~/assets/images/Teams-task-module/webauth.png)\n\n     1. Escribe el URI de redireccionamiento de la aplicación anexando `auth-end` al nombre de dominio completo:</br> \n       `https://d4b8****.ngrok.io/auth-end`. </br>\n\n     1. Habilite **la concesión implícita y los flujos** híbridos seleccionando las siguientes casillas:\n         * **Tokens de id.**\n         * **Tokens de acceso**\n\n     1. Seleccione **Configurar**.\n\n        ![Auth-end](~/assets/images/Teams-task-module/authend.png)\n"
- title: Configurar la configuración de la aplicación y los archivos de manifiesto
  durationInMinutes: 1
  content: "1. Vaya a **appsettings.json** en el repositorio clonado.\n\n    ![Ubicación de configuración de la aplicación](~/assets/images/Teams-task-module/appsettingslocation.png)\n\n1. Abra **appsettings.json** en la versión más reciente de Visual Studio y actualice la siguiente información:  \n\n     * Se `\"MicrosoftAppType\"` establece **en MultiTenant**.\n     * Establece `\"MicrosoftAppId\"` el id. de **la aplicación de Microsoft del bot**.\n     * Se establece `\"MicrosoftAppPassword\"` **en Valor** del **secreto de cliente**.\n     * Se `\"MicrosoftAppTenantId\"` establece en el identificador de inquilino del espacio empresarial donde se usa la aplicación.\n     * Se `\"BaseUrl\"` establece en el nombre de dominio completo (https a io).\n\n    ![Configuración de la aplicación](~/assets/images/Teams-task-module/appsettings.png)\n\n1. Vaya a **manifest.json** en el repositorio clonado.\n\n    ![Ubicación del archivo de manifiesto](~/assets/images/Teams-task-module/manifestlocation.png)\n\n1. Abra **manifest.json** en la versión más reciente de Visual Studio y realice los siguientes cambios:\n\n     * Reemplace todas las repeticiones de `YourDeployedBotUrl.com` por su `WebAppDomain` nombre.\n     * Reemplace todas las repeticiones por `<<YOUR-MICROSOFT-APP-ID>>` el identificador de **aplicación de Microsoft del bot**.\n\n    ![Imagen del manifiesto2](~/assets/images/Teams-task-module/manifest.png)\n"
- title: Compilar y ejecutar el servicio
  durationInMinutes: 1
  content: "**Para compilar y ejecutar el servicio con la versión más reciente de Visual Studio o línea de comandos**\n\n# <a name=\"latest-version-of-visual-studio\"></a>[Versión más reciente de Visual Studio](#tab/latestversionofvisualstudio)\n\n   1. Inicie la versión más reciente de Visual Studio.\n   1. Vaya a **FileOpen** >  >  **Project/Solution**.\n\n      ![Abrir archivo](~/assets/images/meeting-token-generator/meeting-token-generator-VSopenfile.png)\n\n   1. Seleccione **El archivo TeamsTaskModule.csproj** de **la carpeta 54.teams-task-module** .\n\n      ![Archivo proj de CS](~/assets/images/Teams-task-module/csprojfileopen.png)\n\n   1. Abra **Explorador de soluciones** desde **Vista**.\n\n      ![Explorador de soluciones](~/assets/images/Teams-task-module/solutionexplorer.png)\n\n   1. Haga clic con el botón secundario en para **seleccionar TeamsTaskModule**.\n\n   1. Seleccione **Establecer como inicio Project**.\n\n      ![Explorador de soluciones](~/assets/images/Teams-task-module/startup.png)\n\n   1. Pulse **F5** para ejecutar el proyecto.\n\n   1. Seleccione **Sí** si aparece el siguiente cuadro de diálogo:\n\n      ![Certificado de confianza](~/assets/images/Teams-task-module/certificate.png)\n\n      Se abre una página web con un mensaje **El bot está listo**.\n\n      ![Aplicación lista](~/assets/images/Teams-task-module/appisready.png) \n\n    \n# <a name=\"command-line\"></a>[Línea de comandos](#tab/cli)\n\nVaya a **BotBuilder-Samples > ejemplos > csharp_dotnetcore > 54.teams-task-module** en la ventana símbolo del sistema y escriba el siguiente comando:\n\n```bash\ndotnet run\n```\n\n![Dotnet](~/assets/images/Teams-task-module/dotnetruncmd.png)\n"
- title: Upload módulo de tareas
  durationInMinutes: 1
  content: "1. En el repositorio clonado, vaya **a csharp_dotnetcore > 54.teams-task-module > TeamsAppManifest**.\n\n1. Cree una .zip con los siguientes archivos que están presentes en la **carpeta TeamsAppManifest** : \n   * manifest.json\n   * icon-outline.png\n   * icon-color.png\n\n   ![Archivo Zip](~/assets/images/Teams-task-module/zip-file.png) \n\n1. Vaya a **Microsoft Teams**.\n\n1. Seleccione **Aplicaciones**.\n\n   ![Archivo Zip](~/assets/images/Teams-task-module/AppStore.png)\n\n1. En la esquina inferior izquierda, selecciona **Administrar tus aplicaciones**.\n\n   ![Administrar aplicaciones](~/assets/images/Teams-task-module/manage-apps.png)\n\n1. Selecciona **Upload una aplicación en el catálogo de aplicaciones de tu organización**. \n\n   ![Upload aplicación personalizada](~/assets/images/Teams-task-module/upload-app.png)\n\n1. Seleccione **Abrir** para cargar el .zip que creó en la **carpeta TeamsAppManifest** .\n\n   ![Seleccionar archivo zip](~/assets/images/Teams-task-module/select-zip.png)\n\n1. Seleccione **Agregar**.\n\n   ![Agregar la aplicación](~/assets/images/Teams-task-module/add-app.png)\n\n   La aplicación se abre en un chat.\n\n1. Escriba cualquier texto y seleccione Entrar. \n\n   ![Chat](~/assets/images/Teams-task-module/chat_ready.png)\n\n   La aplicación muestra **la invocación del módulo de tareas desde la invocación** de la tarjeta principal y **el módulo de tareas desde la tarjeta adaptable**.         \n"
- title: Interactuar con la aplicación en Teams
  durationInMinutes: 1
  content: >
    1. Selecciona **Tarjeta adaptable en** **Invocación del módulo de tareas desde La invocación** de la tarjeta principal o del módulo **de tareas desde la tarjeta adaptable**.

       ![Tarjeta adaptable](~/assets/images/Teams-task-module/adaptive-card.png)

    1. Escriba cualquier texto.


    1. Seleccione **Enviar**.

       ![Texto de tarjeta adaptable](~/assets/images/Teams-task-module/adaptive-card-text.png)

       **La tarjeta adaptable** envía un mensaje de confirmación.

       ![Envío de tarjeta adaptable](~/assets/images/Teams-task-module/adaptive-card-submit.png)

    1. Seleccione **Formulario personalizado en** **Invocación de módulo de tareas desde La invocación** de tarjeta principal o módulo **de tareas desde la tarjeta adaptable**.

       ![Formulario personalizado](~/assets/images/Teams-task-module/custom-form.png)

    1. Escriba la información necesaria:

       * **Name**
       * **Correo electrónico**
       * **Libro favorito**
       * **Password**
       * **Confirmar contraseña**

    1. Seleccione **Registrarse**.

       ![Texto del formulario personalizado](~/assets/images/Teams-task-module/custom-text.png)

       **El formulario personalizado** envía un mensaje de confirmación.

       ![Registrarse](~/assets/images/Teams-task-module/custom-on-sign-up.png)

       La siguiente información aparece en el chat:

       ![Chat](~/assets/images/Teams-task-module/adaptive-custom-chat.png)

    1. Selecciona **You Tube** from **Task Module Invocation from Hero Card** or **Task Module Invocation from Adaptive Card**.

       ![YouTube](~/assets/images/Teams-task-module/youtube.png)

    1. Selecciona **Reproducir**.

       ![Selección de YouTube](~/assets/images/Teams-task-module/youtube-select.png)

       Se reproduce el vídeo.
- title: Desafío completo
  durationInMinutes: 1
  content: >
    ¿Has llegado a algo como esto?

       ![Módulo de tareas](~/assets/images/Teams-task-module/final_image.png)
- content: Has completado el tutorial para empezar a usar la Teams módulo de tareas.
