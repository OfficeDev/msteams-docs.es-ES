---
title: Creación de una etiqueta de eliminación
author: laujan
description: Cómo crear una página de eliminación de pestañas
keywords: equipos pestañas canal de grupo configurable eliminar eliminar
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: e1a1f38a2bcb3b5bc4bc54f469c8727e44d8695e
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566673"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="58aed-104">Modificar o eliminar una pestaña de grupo de canales</span><span class="sxs-lookup"><span data-stu-id="58aed-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="58aed-105">Puede ampliar y mejorar la experiencia del usuario mediante la compatibilidad con las opciones de eliminación y modificación en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="58aed-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="58aed-106">Teams permite a los usuarios cambiar el nombre o quitar una pestaña de canal/grupo y puede permitir que los usuarios reconfiguran la pestaña después de la instalación.</span><span class="sxs-lookup"><span data-stu-id="58aed-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="58aed-107">Además, la experiencia de eliminación de pestañas puede incluir la des designador lo que sucede con el contenido cuando se quita la pestaña o dar a los usuarios opciones posteriores a la eliminación, como eliminar o archivar el contenido.</span><span class="sxs-lookup"><span data-stu-id="58aed-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="58aed-108">Habilite la pestaña para que se reconfigure después de la instalación</span><span class="sxs-lookup"><span data-stu-id="58aed-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="58aed-109">El **manifest.jsdefine** las características y capacidades de la pestaña.</span><span class="sxs-lookup"><span data-stu-id="58aed-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="58aed-110">La propiedad tab instance `canUpdateConfiguration` toma un valor booleano que indica si un usuario puede modificar o volver a configurar la pestaña después de crearla:</span><span class="sxs-lookup"><span data-stu-id="58aed-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="58aed-111">Nombre</span><span class="sxs-lookup"><span data-stu-id="58aed-111">Name</span></span>| <span data-ttu-id="58aed-112">Tipo</span><span class="sxs-lookup"><span data-stu-id="58aed-112">Type</span></span>| <span data-ttu-id="58aed-113">Tamaño máximo</span><span class="sxs-lookup"><span data-stu-id="58aed-113">Maximum size</span></span> | <span data-ttu-id="58aed-114">Necesario</span><span class="sxs-lookup"><span data-stu-id="58aed-114">Required</span></span> | <span data-ttu-id="58aed-115">Descripción</span><span class="sxs-lookup"><span data-stu-id="58aed-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="58aed-116">Booleano</span><span class="sxs-lookup"><span data-stu-id="58aed-116">Boolean</span></span>|||<span data-ttu-id="58aed-117">Valor que indica si el usuario puede actualizar una instancia de la configuración de la pestaña después de la creación.</span><span class="sxs-lookup"><span data-stu-id="58aed-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="58aed-118">predeterminado: `true`</span><span class="sxs-lookup"><span data-stu-id="58aed-118">Default: `true`</span></span>|

<span data-ttu-id="58aed-119">Cuando la pestaña se carga en un canal o chat de grupo, Teams agregará un menú desplegable con el botón derecho del ratón para la pestaña. Las opciones disponibles están determinadas por la `canUpdateConfiguration` configuración:</span><span class="sxs-lookup"><span data-stu-id="58aed-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="58aed-120">true</span><span class="sxs-lookup"><span data-stu-id="58aed-120">true</span></span>   | <span data-ttu-id="58aed-121">false</span><span class="sxs-lookup"><span data-stu-id="58aed-121">false</span></span> | <span data-ttu-id="58aed-122">description</span><span class="sxs-lookup"><span data-stu-id="58aed-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="58aed-123">Configuración</span><span class="sxs-lookup"><span data-stu-id="58aed-123">Settings</span></span>            |   <span data-ttu-id="58aed-124">√</span><span class="sxs-lookup"><span data-stu-id="58aed-124">√</span></span>    |       |<span data-ttu-id="58aed-125">La `configurationUrl` página se vuelve a cargar en un IFrame que permite al usuario reconfigurar la pestaña.</span><span class="sxs-lookup"><span data-stu-id="58aed-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="58aed-126">Cambiar nombre</span><span class="sxs-lookup"><span data-stu-id="58aed-126">Rename</span></span>              |   <span data-ttu-id="58aed-127">√</span><span class="sxs-lookup"><span data-stu-id="58aed-127">√</span></span>    |   <span data-ttu-id="58aed-128">√</span><span class="sxs-lookup"><span data-stu-id="58aed-128">√</span></span>   | <span data-ttu-id="58aed-129">El usuario puede cambiar el nombre de la pestaña tal como aparece en la barra de pestañas.</span><span class="sxs-lookup"><span data-stu-id="58aed-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="58aed-130">Eliminar </span><span class="sxs-lookup"><span data-stu-id="58aed-130">Remove</span></span>              |   <span data-ttu-id="58aed-131">√</span><span class="sxs-lookup"><span data-stu-id="58aed-131">√</span></span>    |   <span data-ttu-id="58aed-132">√</span><span class="sxs-lookup"><span data-stu-id="58aed-132">√</span></span>   |  <span data-ttu-id="58aed-133">Si la  `removeURL` propiedad y el valor se incluyen en la página de **configuración,** la **página de eliminación** se carga en un IFrame y se presenta al usuario.</span><span class="sxs-lookup"><span data-stu-id="58aed-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="58aed-134">Si no se incluye una página de eliminación, el usuario se presenta con un cuadro de diálogo confirmar.</span><span class="sxs-lookup"><span data-stu-id="58aed-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="58aed-135">Cree una página de eliminación de pestañas para la aplicación</span><span class="sxs-lookup"><span data-stu-id="58aed-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="58aed-136">La página de eliminación opcional es una página HTML que hospeda y se muestra cuando se quita la pestaña.</span><span class="sxs-lookup"><span data-stu-id="58aed-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="58aed-137">La dirección URL de la página de eliminación se designa mediante el `setSettings()` método dentro de la página de configuración.</span><span class="sxs-lookup"><span data-stu-id="58aed-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="58aed-138">Al igual que con todas las páginas de la aplicación, la página de eliminación debe cumplir con [los requisitos de Teams pestaña.](../../../tabs/how-to/tab-requirements.md)</span><span class="sxs-lookup"><span data-stu-id="58aed-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="58aed-139">Registrar un controlador remove</span><span class="sxs-lookup"><span data-stu-id="58aed-139">Register a remove handler</span></span>

<span data-ttu-id="58aed-140">Opcionalmente, dentro de la lógica de la página de eliminación, puede invocar el `registerOnRemoveHandler((RemoveEvent) => {}` controlador de eventos cuando el usuario quita una configuración de pestaña existente.</span><span class="sxs-lookup"><span data-stu-id="58aed-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="58aed-141">El método toma la [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interfaz y ejecuta el código en el controlador cuando un usuario intenta quitar contenido.</span><span class="sxs-lookup"><span data-stu-id="58aed-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="58aed-142">Se utiliza para realizar operaciones de limpieza, como quitar el recurso subyacente que alimenta el contenido de la pestaña.</span><span class="sxs-lookup"><span data-stu-id="58aed-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="58aed-143">Solo se puede registrar un controlador remove a la vez.</span><span class="sxs-lookup"><span data-stu-id="58aed-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="58aed-144">La `RemoveEvent` interfaz describe un objeto con dos métodos:</span><span class="sxs-lookup"><span data-stu-id="58aed-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="58aed-145">Se `notifySuccess()` requiere la función.</span><span class="sxs-lookup"><span data-stu-id="58aed-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="58aed-146">Indica que la eliminación del recurso subyacente se realizó correctamente y se puede quitar su contenido.</span><span class="sxs-lookup"><span data-stu-id="58aed-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="58aed-147">La `notifyFailure(string)` función es opcional.</span><span class="sxs-lookup"><span data-stu-id="58aed-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="58aed-148">Indica que se ha fallado en la eliminación del recurso subyacente y no se puede quitar su contenido.</span><span class="sxs-lookup"><span data-stu-id="58aed-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="58aed-149">El parámetro de cadena opcional especifica un motivo del error.</span><span class="sxs-lookup"><span data-stu-id="58aed-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="58aed-150">Si se proporciona, esta cadena se muestra al usuario; de lo contrario, se muestra un error genérico.</span><span class="sxs-lookup"><span data-stu-id="58aed-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="58aed-151">Utilice la `getSettings()` función</span><span class="sxs-lookup"><span data-stu-id="58aed-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="58aed-152">Puede utilizar `getSettings()` para designar el contenido de la pestaña que se va a quitar.</span><span class="sxs-lookup"><span data-stu-id="58aed-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="58aed-153">La `getSettings((Settings) =>{})` función toma y proporciona los valores de propiedad de configuración [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) válidos que se pueden recuperar.</span><span class="sxs-lookup"><span data-stu-id="58aed-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="58aed-154">Utilice la `getContext()` función</span><span class="sxs-lookup"><span data-stu-id="58aed-154">Use the `getContext()` function</span></span>

<span data-ttu-id="58aed-155">Puede usar `getContext()` para recuperar el contexto actual en el que se ejecuta el marco.</span><span class="sxs-lookup"><span data-stu-id="58aed-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="58aed-156">La `getContext((Context) =>{})` función toma y proporciona valores de propiedad [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) válidos que puede usar en la lógica `Context` de la página de eliminación para determinar el contenido que se mostrará en la página de eliminación.</span><span class="sxs-lookup"><span data-stu-id="58aed-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="58aed-157">Incluir autenticación</span><span class="sxs-lookup"><span data-stu-id="58aed-157">Include authentication</span></span>

<span data-ttu-id="58aed-158">Es posible que necesite autenticación antes de permitir que un usuario elimine el contenido de la pestaña.</span><span class="sxs-lookup"><span data-stu-id="58aed-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="58aed-159">La información de contexto se puede usar para ayudar a construir solicitudes de autenticación y direcciones URL de página de autorización.</span><span class="sxs-lookup"><span data-stu-id="58aed-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="58aed-160">Consulte [Microsoft Teams flujo de autenticación para las pestañas](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="58aed-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="58aed-161">Asegúrese de que todos los dominios utilizados en las páginas de pestañas aparecen en la `manifest.json` `validDomains` matriz.</span><span class="sxs-lookup"><span data-stu-id="58aed-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="58aed-162">A continuación se muestra un bloque de código de eliminación de pestañas de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="58aed-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="58aed-163">Cuando un usuario selecciona **Quitar** en el menú desplegable de la pestaña, Teams cargará la página opcional `removeUrl` (designada en la **página de configuración)** en un IFrame.</span><span class="sxs-lookup"><span data-stu-id="58aed-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="58aed-164">Aquí, el usuario se presenta con un botón cargado con la `onClick()` función que llama y `microsoftTeams.settings.setValidityState(true)` habilita el botón **Quitar** situado cerca de la parte inferior de la página de eliminación IFrame.</span><span class="sxs-lookup"><span data-stu-id="58aed-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="58aed-165">Después de la ejecución del controlador remove, `removeEvent.notifySuccess()` o `removeEvent.notifyFailure()` notifica Teams del resultado de eliminación de contenido.</span><span class="sxs-lookup"><span data-stu-id="58aed-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="58aed-166">Para asegurarse de que no se inhibe el control de un usuario autorizado sobre una pestaña, Teams quitará la pestaña tanto en casos de éxito como de error.</span><span class="sxs-lookup"><span data-stu-id="58aed-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.</span></span>\
> * <span data-ttu-id="58aed-167">Teams activa el botón **Quitar** después de 5 segundos, incluso si la pestaña no ha llamado `setValidityState()` a .</span><span class="sxs-lookup"><span data-stu-id="58aed-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.</span></span>\
> * <span data-ttu-id="58aed-168">Cuando el usuario selecciona **Quitar** Teams quita la pestaña después de 30 segundos, independientemente de si las acciones se han completado.</span><span class="sxs-lookup"><span data-stu-id="58aed-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
