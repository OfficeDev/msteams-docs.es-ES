---
title: Creación de una etiqueta de eliminación
author: surbhigupta
description: Cómo crear una página de eliminación de pestañas
keywords: Teams tabs group channel configurable remove delete
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: 1b4ef5435ad1be82726edbf02d7205c0b1feba06
ms.sourcegitcommit: 4d9d1542e04abacfb252511c665a7229d8bb7162
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/25/2021
ms.locfileid: "53140197"
---
# <a name="create-a-removal-page"></a><span data-ttu-id="162dd-104">Crear una página de eliminación</span><span class="sxs-lookup"><span data-stu-id="162dd-104">Create a removal page</span></span>

<span data-ttu-id="162dd-105">Puedes ampliar y mejorar la experiencia del usuario si admites opciones de eliminación y modificación en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="162dd-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="162dd-106">Teams permite a los usuarios cambiar el nombre o quitar una pestaña de canal o grupo y puede permitir que los usuarios vuelvan a configurar la pestaña después de la instalación.</span><span class="sxs-lookup"><span data-stu-id="162dd-106">Teams enables users to rename or remove a channel or group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="162dd-107">Además, la experiencia de eliminación de pestañas proporciona a los usuarios opciones posteriores a la eliminación para eliminar o archivar contenido.</span><span class="sxs-lookup"><span data-stu-id="162dd-107">Additionally, the tab removal experience provides the users with post-removal options to delete or archive content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="162dd-108">Habilitar la pestaña para volver a configurarse después de la instalación</span><span class="sxs-lookup"><span data-stu-id="162dd-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="162dd-109">El **manifest.jsen** define las características y capacidades de la pestaña.</span><span class="sxs-lookup"><span data-stu-id="162dd-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="162dd-110">La propiedad de instancia de tabulación toma un valor booleano que indica si un usuario puede modificar o `canUpdateConfiguration` volver a configurar la pestaña después de crearla.</span><span class="sxs-lookup"><span data-stu-id="162dd-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created.</span></span> <span data-ttu-id="162dd-111">En la tabla siguiente se proporcionan los detalles de la propiedad:</span><span class="sxs-lookup"><span data-stu-id="162dd-111">The following table provides the property details:</span></span>

|<span data-ttu-id="162dd-112">Nombre</span><span class="sxs-lookup"><span data-stu-id="162dd-112">Name</span></span>| <span data-ttu-id="162dd-113">Tipo</span><span class="sxs-lookup"><span data-stu-id="162dd-113">Type</span></span>| <span data-ttu-id="162dd-114">Tamaño máximo</span><span class="sxs-lookup"><span data-stu-id="162dd-114">Maximum size</span></span> | <span data-ttu-id="162dd-115">Necesario</span><span class="sxs-lookup"><span data-stu-id="162dd-115">Required</span></span> | <span data-ttu-id="162dd-116">Descripción</span><span class="sxs-lookup"><span data-stu-id="162dd-116">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="162dd-117">Booleano</span><span class="sxs-lookup"><span data-stu-id="162dd-117">Boolean</span></span>|||<span data-ttu-id="162dd-118">Valor que indica si el usuario puede actualizar una instancia de la configuración de la pestaña después de su creación.</span><span class="sxs-lookup"><span data-stu-id="162dd-118">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="162dd-119">El valor predeterminado es `true`.</span><span class="sxs-lookup"><span data-stu-id="162dd-119">Default is `true`.</span></span> |

<span data-ttu-id="162dd-120">Cuando la pestaña se carga en un canal o un chat de grupo, Teams un menú desplegable con el botón secundario para la pestaña. Las opciones disponibles están determinadas por la `canUpdateConfiguration` configuración.</span><span class="sxs-lookup"><span data-stu-id="162dd-120">When your tab is uploaded to a channel or group chat, Teams adds a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting.</span></span> <span data-ttu-id="162dd-121">En la tabla siguiente se proporcionan los detalles de configuración:</span><span class="sxs-lookup"><span data-stu-id="162dd-121">The following table provides the setting details:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="162dd-122">true</span><span class="sxs-lookup"><span data-stu-id="162dd-122">true</span></span>   | <span data-ttu-id="162dd-123">false</span><span class="sxs-lookup"><span data-stu-id="162dd-123">false</span></span> | <span data-ttu-id="162dd-124">description</span><span class="sxs-lookup"><span data-stu-id="162dd-124">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="162dd-125">Configuración</span><span class="sxs-lookup"><span data-stu-id="162dd-125">Settings</span></span>            |   <span data-ttu-id="162dd-126">√</span><span class="sxs-lookup"><span data-stu-id="162dd-126">√</span></span>    |       |<span data-ttu-id="162dd-127">La página se vuelve a cargar en un IFrame que permite al usuario volver a `configurationUrl` configurar la pestaña.</span><span class="sxs-lookup"><span data-stu-id="162dd-127">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span> |
|     <span data-ttu-id="162dd-128">Cambiar nombre</span><span class="sxs-lookup"><span data-stu-id="162dd-128">Rename</span></span>              |   <span data-ttu-id="162dd-129">√</span><span class="sxs-lookup"><span data-stu-id="162dd-129">√</span></span>    |   <span data-ttu-id="162dd-130">√</span><span class="sxs-lookup"><span data-stu-id="162dd-130">√</span></span>   | <span data-ttu-id="162dd-131">El usuario puede cambiar el nombre de la pestaña tal como aparece en la barra de pestañas.</span><span class="sxs-lookup"><span data-stu-id="162dd-131">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="162dd-132">Eliminar </span><span class="sxs-lookup"><span data-stu-id="162dd-132">Remove</span></span>              |   <span data-ttu-id="162dd-133">√</span><span class="sxs-lookup"><span data-stu-id="162dd-133">√</span></span>    |   <span data-ttu-id="162dd-134">√</span><span class="sxs-lookup"><span data-stu-id="162dd-134">√</span></span>   |  <span data-ttu-id="162dd-135">Si la propiedad y el valor se incluyen en la página de configuración, la página de eliminación se carga en un `removeURL` IFrame y se presenta al usuario.  </span><span class="sxs-lookup"><span data-stu-id="162dd-135">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="162dd-136">Si no se incluye una página de eliminación, se muestra al usuario un cuadro de diálogo de confirmación.</span><span class="sxs-lookup"><span data-stu-id="162dd-136">If a removal page is not included, the user is presented with a confirm dialog box.</span></span>          |

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="162dd-137">Crear una página de eliminación de pestañas para la aplicación</span><span class="sxs-lookup"><span data-stu-id="162dd-137">Create a tab removal page for your application</span></span>

<span data-ttu-id="162dd-138">La página de eliminación opcional es una página HTML que hospeda y se muestra cuando se quita la pestaña.</span><span class="sxs-lookup"><span data-stu-id="162dd-138">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="162dd-139">La dirección URL de la página de eliminación la designa `setSettings()` el método dentro de la página de configuración.</span><span class="sxs-lookup"><span data-stu-id="162dd-139">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="162dd-140">Al igual que con todas las páginas de la aplicación, la página de eliminación debe cumplir Teams [requisitos previos de la pestaña](../../../tabs/how-to/tab-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="162dd-140">As with all pages in your app, the removal page must comply with [Teams tab prerequisites](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="162dd-141">Registrar un controlador de eliminación</span><span class="sxs-lookup"><span data-stu-id="162dd-141">Register a remove handler</span></span>

<span data-ttu-id="162dd-142">Opcionalmente, dentro de la lógica de la página de eliminación, puede invocar el controlador de eventos cuando el `registerOnRemoveHandler((RemoveEvent) => {}` usuario quita una configuración de pestaña existente.</span><span class="sxs-lookup"><span data-stu-id="162dd-142">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="162dd-143">El método toma la interfaz y ejecuta el código en el controlador cuando un [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) usuario intenta quitar contenido.</span><span class="sxs-lookup"><span data-stu-id="162dd-143">The method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="162dd-144">El método se usa para realizar operaciones de limpieza, como quitar el recurso subyacente que activa el contenido de la pestaña.</span><span class="sxs-lookup"><span data-stu-id="162dd-144">The method is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="162dd-145">A la vez, solo se puede registrar un controlador de eliminación.</span><span class="sxs-lookup"><span data-stu-id="162dd-145">At a time only one remove handler can be registered.</span></span>

<span data-ttu-id="162dd-146">La `RemoveEvent` interfaz describe un objeto con dos métodos:</span><span class="sxs-lookup"><span data-stu-id="162dd-146">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="162dd-147">La `notifySuccess()` función es necesaria.</span><span class="sxs-lookup"><span data-stu-id="162dd-147">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="162dd-148">Indica que la eliminación del recurso subyacente se ha hecho correctamente y se puede quitar su contenido.</span><span class="sxs-lookup"><span data-stu-id="162dd-148">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="162dd-149">La `notifyFailure(string)` función es opcional.</span><span class="sxs-lookup"><span data-stu-id="162dd-149">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="162dd-150">Indica que se ha fallado la eliminación del recurso subyacente y que no se puede quitar su contenido.</span><span class="sxs-lookup"><span data-stu-id="162dd-150">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="162dd-151">El parámetro de cadena opcional especifica un motivo del error.</span><span class="sxs-lookup"><span data-stu-id="162dd-151">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="162dd-152">Si se proporciona, esta cadena se muestra al usuario; si no se muestra un error genérico.</span><span class="sxs-lookup"><span data-stu-id="162dd-152">If provided, this string is displayed to the user; else a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="162dd-153">Usar la `getSettings()` función</span><span class="sxs-lookup"><span data-stu-id="162dd-153">Use the `getSettings()` function</span></span>

<span data-ttu-id="162dd-154">Puede usar para `getSettings()` asignar el contenido de la pestaña que se va a quitar.</span><span class="sxs-lookup"><span data-stu-id="162dd-154">You can use `getSettings()`to assign the tab content to be removed.</span></span> <span data-ttu-id="162dd-155">La función toma el y proporciona los valores de propiedad de configuración `getSettings((Settings) =>{})` [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) válidos que se pueden recuperar.</span><span class="sxs-lookup"><span data-stu-id="162dd-155">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="162dd-156">Usar la `getContext()` función</span><span class="sxs-lookup"><span data-stu-id="162dd-156">Use the `getContext()` function</span></span>

<span data-ttu-id="162dd-157">Puede usar para `getContext()` obtener el contexto actual en el que se está ejecutando el marco.</span><span class="sxs-lookup"><span data-stu-id="162dd-157">You can use `getContext()` to get the current context in which the frame is running.</span></span> <span data-ttu-id="162dd-158">La `getContext((Context) =>{})` función toma el [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) .</span><span class="sxs-lookup"><span data-stu-id="162dd-158">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true).</span></span> <span data-ttu-id="162dd-159">La función proporciona valores de propiedad válidos que puede usar en la lógica de la página de eliminación para determinar el contenido que se va a `Context` mostrar en la página de eliminación.</span><span class="sxs-lookup"><span data-stu-id="162dd-159">The function provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="162dd-160">Incluir autenticación</span><span class="sxs-lookup"><span data-stu-id="162dd-160">Include authentication</span></span>

<span data-ttu-id="162dd-161">La autenticación es necesaria antes de permitir que un usuario elimine el contenido de la pestaña.</span><span class="sxs-lookup"><span data-stu-id="162dd-161">Authentication is required before allowing a user to delete the tab content.</span></span> <span data-ttu-id="162dd-162">La información de contexto se puede usar para ayudar a construir solicitudes de autenticación y direcciones URL de página de autorización.</span><span class="sxs-lookup"><span data-stu-id="162dd-162">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="162dd-163">Vea [Microsoft Teams de autenticación para las pestañas](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="162dd-163">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="162dd-164">Asegúrese de que todos los dominios usados en las páginas de pestañas se enumeran en la `manifest.json` `validDomains` matriz.</span><span class="sxs-lookup"><span data-stu-id="162dd-164">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="162dd-165">A continuación se muestra un bloque de código de eliminación de fichas de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="162dd-165">The following is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="162dd-166">Cuando un usuario selecciona **Quitar** del menú desplegable de la pestaña, Teams carga la página opcional asignada en la página de configuración `removeUrl` , en un IFrame. </span><span class="sxs-lookup"><span data-stu-id="162dd-166">When a user selects **Remove** from the tab's drop-down menu, Teams loads the optional `removeUrl` page assigned in your **configuration page**, into an IFrame.</span></span> <span data-ttu-id="162dd-167">Se muestra al usuario un botón cargado con la función que llama y habilita el botón Quitar que se muestra en la parte inferior de la página `onClick()` `microsoftTeams.settings.setValidityState(true)` de eliminación IFrame. </span><span class="sxs-lookup"><span data-stu-id="162dd-167">The user is shown a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button shown at the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="162dd-168">Después de ejecutar el controlador de eliminación o notificar Teams el resultado de eliminación `removeEvent.notifySuccess()` `removeEvent.notifyFailure()` de contenido.</span><span class="sxs-lookup"><span data-stu-id="162dd-168">After the remove handler is executed, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="162dd-169">Para asegurarse de que no se inhiba el control de un usuario autorizado sobre una pestaña, Teams elimina la pestaña en los casos de éxito y error.</span><span class="sxs-lookup"><span data-stu-id="162dd-169">To ensure that an authorized user's control over a tab is not inhibited, Teams removes the tab in both success and failure cases.</span></span>
> * <span data-ttu-id="162dd-170">Teams activa el **botón Quitar** después de cinco segundos, incluso si la pestaña no ha llamado `setValidityState()` a .</span><span class="sxs-lookup"><span data-stu-id="162dd-170">Teams enables the **Remove** button after five seconds, even if your tab has not called `setValidityState()`.</span></span>
> * <span data-ttu-id="162dd-171">Cuando el usuario selecciona **Quitar**, Teams quita la pestaña después de 30 segundos, independientemente de si las acciones se han completado o no.</span><span class="sxs-lookup"><span data-stu-id="162dd-171">When the user selects **Remove**, Teams removes the tab after 30 seconds regardless of whether the actions have been completed or not.</span></span>

## <a name="see-also"></a><span data-ttu-id="162dd-172">Vea también</span><span class="sxs-lookup"><span data-stu-id="162dd-172">See also</span></span>

* [<span data-ttu-id="162dd-173">Teams pestañas</span><span class="sxs-lookup"><span data-stu-id="162dd-173">Teams tabs</span></span>](~/tabs/what-are-tabs.md)
* [<span data-ttu-id="162dd-174">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="162dd-174">Prerequisites</span></span>](~/tabs/how-to/tab-requirements.md)
* [<span data-ttu-id="162dd-175">Crear una pestaña personal</span><span class="sxs-lookup"><span data-stu-id="162dd-175">Create a personal tab</span></span>](~/tabs/how-to/create-personal-tab.md)
* [<span data-ttu-id="162dd-176">Crear una pestaña de canal o grupo</span><span class="sxs-lookup"><span data-stu-id="162dd-176">Create a channel or group tab</span></span>](~/tabs/how-to/create-channel-group-tab.md)
* [<span data-ttu-id="162dd-177">Creación de una página de contenido</span><span class="sxs-lookup"><span data-stu-id="162dd-177">Create a content page</span></span>](~/tabs/how-to/create-tab-pages/content-page.md)
* [<span data-ttu-id="162dd-178">Creación de una página de configuración</span><span class="sxs-lookup"><span data-stu-id="162dd-178">Create a configuration page</span></span>](~/tabs/how-to/create-tab-pages/configuration-page.md)
* [<span data-ttu-id="162dd-179">Obtención del contexto de Teams para la pestaña</span><span class="sxs-lookup"><span data-stu-id="162dd-179">Get context for your tab</span></span>](~/tabs/how-to/access-teams-context.md)
* [<span data-ttu-id="162dd-180">Compilar pestañas con tarjetas adaptables</span><span class="sxs-lookup"><span data-stu-id="162dd-180">Build tabs with Adaptive Cards</span></span>](~/tabs/how-to/build-adaptive-card-tabs.md)
* [<span data-ttu-id="162dd-181">Expansión del vínculo de la pestaña y vista de fases</span><span class="sxs-lookup"><span data-stu-id="162dd-181">Tabs link unfurling and Stage View</span></span>](~/tabs/tabs-link-unfurling.md)
* [<span data-ttu-id="162dd-182">Crear pestañas de conversación</span><span class="sxs-lookup"><span data-stu-id="162dd-182">Create conversational tabs</span></span>](~/tabs/how-to/conversational-tabs.md)
* [<span data-ttu-id="162dd-183">Cambios del margen de pestaña</span><span class="sxs-lookup"><span data-stu-id="162dd-183">Tab margin changes</span></span>](~/resources/removing-tab-margins.md)

## <a name="next-step"></a><span data-ttu-id="162dd-184">Paso siguiente</span><span class="sxs-lookup"><span data-stu-id="162dd-184">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="162dd-185">Pestañas en dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="162dd-185">Tabs on mobile</span></span>](~/tabs/design/tabs-mobile.md)