---
title: Flujo de autenticación para pestañas
description: Describe el flujo de autenticación en pestañas
ms.topic: conceptual
keywords: pestañas de flujo de autenticación de teams
ms.openlocfilehash: 9505419a6594529bcf8d19a90d029705e573c67b
ms.sourcegitcommit: 976e870cc925f61b76c3830ec04ba6e4bdfde32f
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/27/2021
ms.locfileid: "50014589"
---
# <a name="microsoft-teams-authentication-flow-for-tabs"></a><span data-ttu-id="c6f3d-104">Flujo de autenticación de Microsoft Teams para pestañas</span><span class="sxs-lookup"><span data-stu-id="c6f3d-104">Microsoft Teams authentication flow for tabs</span></span>

> [!Note]
> <span data-ttu-id="c6f3d-105">Para que la autenticación funcione para su pestaña en clientes móviles, debe asegurarse de que está usando al menos la versión 1.4.1 del SDK de JavaScript de Teams.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-105">For authentication to work for your tab on mobile clients, you need to ensure you're using at least the 1.4.1 version of the Teams JavaScript SDK.</span></span>
> <span data-ttu-id="c6f3d-106">El SDK de Teams inicia una ventana independiente para el flujo de autenticación y, por lo tanto, el mismo atributo de sitio se puede establecer en "Lax".</span><span class="sxs-lookup"><span data-stu-id="c6f3d-106">Teams SDK launches separate window for authentication flow and hence samesite attribute can be set to 'Lax'.</span></span> <span data-ttu-id="c6f3d-107">Actualmente, SameSite=None no es compatible con el cliente de escritorio de Teams ni con versiones anteriores de Chrome o Safari.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-107">Currently, SameSite=None is not supported by the Teams desktop client or older versions of Chrome or Safari.</span></span>

<span data-ttu-id="c6f3d-108">OAuth 2.0 es un estándar abierto para la autenticación y autorización usados por Azure AD y muchos otros proveedores de identidades.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-108">OAuth 2.0 is an open standard for authentication and authorization used by Azure AD and many other identity providers.</span></span> <span data-ttu-id="c6f3d-109">Un conocimiento básico de OAuth 2.0 es un requisito previo para trabajar con la autenticación en Teams; [esta es una buena introducción](https://aaronparecki.com/oauth-2-simplified/) que es más fácil de seguir que la [especificación formal.](https://oauth.net/2/)</span><span class="sxs-lookup"><span data-stu-id="c6f3d-109">A basic understanding of OAuth 2.0 is a prerequisite for working with authentication in Teams; [here's a good overview](https://aaronparecki.com/oauth-2-simplified/) that's easier to follow than the [formal specification](https://oauth.net/2/).</span></span> <span data-ttu-id="c6f3d-110">El flujo de autenticación para pestañas y bots es un poco diferente porque las pestañas son muy similares a los sitios web para que puedan usar OAuth 2.0 directamente; Los bots no son y deben hacer algunas cosas de forma diferente, pero los conceptos básicos son idénticos.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-110">Authentication flow for tabs and bots are a little different because tabs are very similar to websites so they can use OAuth 2.0 directly; bots are not and must do a few things differently, but the core concepts are identical.</span></span>

<span data-ttu-id="c6f3d-111">*Vea*, iniciar el flujo de autenticación para [pestañas](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow) para obtener un ejemplo de flujo de autenticación para pestañas y bots con Node y el tipo de concesión implícita [de OAuth 2.0](https://oauth.net/2/grant-types/implicit/).</span><span class="sxs-lookup"><span data-stu-id="c6f3d-111">*See*, [Initiate authentication flow for tabs](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow) for an example of authentication flow for tabs and bots using Node and the [OAuth 2.0 implicit grant type](https://oauth.net/2/grant-types/implicit/).</span></span>

![Diagrama de secuencia de autenticación de tabulación](~/assets/images/authentication/tab_auth_sequence_diagram.png)

1. <span data-ttu-id="c6f3d-113">El usuario interactúa con el contenido de la página de configuración o contenido de la pestaña, normalmente un botón denominado "Iniciar sesión" o "Iniciar sesión".</span><span class="sxs-lookup"><span data-stu-id="c6f3d-113">The user interacts with the content on the tab configuration or content page, commonly a button labeled "Sign in" or "Log in".</span></span>
2. <span data-ttu-id="c6f3d-114">La pestaña crea la dirección URL para su página de inicio de autenticación, opcionalmente usando información de marcadores de posición de dirección URL o llamando al método de SDK de cliente de Teams para simplificar la experiencia de autenticación `microsoftTeams.getContext()` para el usuario.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-114">The tab constructs the URL for its auth start page, optionally using information from URL placeholders or by calling `microsoftTeams.getContext()` Teams client SDK method to streamline the authentication experience for the user.</span></span> <span data-ttu-id="c6f3d-115">Por ejemplo, al autenticar con Azure AD, si el parámetro se establece en la dirección de correo electrónico del usuario, es posible que el usuario ni siquiera tenga que iniciar sesión si lo ha hecho recientemente, porque Azure AD usará las credenciales almacenadas en caché del usuario si es posible: el elemento emergente parpadeará brevemente y `login_hint` desaparecerá.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-115">For example, when authenticating with Azure AD, if the `login_hint` parameter is set to the user's email address, the user may not even have to sign in if they have done so recently, because Azure AD will use the user's cached credentials if possible: the popup will flash briefly and then disappear.</span></span>
3. <span data-ttu-id="c6f3d-116">A continuación, la pestaña llama `microsoftTeams.authentication.authenticate()` al método y registra las funciones `successCallback` `failureCallback` y.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-116">The tab then calls the `microsoftTeams.authentication.authenticate()` method and registers the `successCallback` and `failureCallback` functions.</span></span>
4. <span data-ttu-id="c6f3d-117">Teams abre la página de inicio en un iframe en una ventana emergente.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-117">Teams opens the start page in an iframe in a pop-up window.</span></span> <span data-ttu-id="c6f3d-118">La página de inicio genera datos aleatorios, los guarda para su validación futura y redirige al punto de conexión del proveedor de identidades, como `state` `/authorize` azure `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` AD.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-118">The start page generates random `state` data, saves it for future validation, and redirects to the identity provider's `/authorize` endpoint such as `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` for Azure AD.</span></span> <span data-ttu-id="c6f3d-119">Reemplace `<tenant id>` por su propio identificador de inquilino (context.tid).</span><span class="sxs-lookup"><span data-stu-id="c6f3d-119">Replace `<tenant id>` with your own tenant id (context.tid).</span></span>
    * <span data-ttu-id="c6f3d-120">Al igual que otros flujos de autenticación de aplicaciones en Teams, la página de inicio debe estar en un dominio que esté en su lista y en el mismo dominio que la página de redireccionamiento posterior al inicio `validDomains` de sesión.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-120">Like other application auth flows in Teams, the start page must be on a domain that's in its `validDomains` list, and on the same domain as the post-login redirect page.</span></span>
    * <span data-ttu-id="c6f3d-121">**IMPORTANTE:** Las llamadas implícitas de flujo de concesión de OAuth 2.0 para un parámetro en la solicitud de autenticación que contiene datos de sesión únicos para evitar un ataque de falsificación de solicitud entre `state` [sitios.](https://en.wikipedia.org/wiki/Cross-site_request_forgery)</span><span class="sxs-lookup"><span data-stu-id="c6f3d-121">**IMPORTANT**: The OAuth 2.0 implicit grant flow calls for a `state` parameter in the authentication request which contains unique session data to prevent a [cross-site request forgery attack](https://en.wikipedia.org/wiki/Cross-site_request_forgery).</span></span> <span data-ttu-id="c6f3d-122">Los ejemplos siguientes usan un GUID generado aleatoriamente para los `state` datos.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-122">The examples below use a randomly-generated GUID for the `state` data.</span></span>
5. <span data-ttu-id="c6f3d-123">En el sitio del proveedor, el usuario inicia sesión y concede acceso a la pestaña.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-123">On the provider's site, the user signs in and grants access to the tab.</span></span>
6. <span data-ttu-id="c6f3d-124">El proveedor lleva al usuario a la página de redireccionamiento de OAuth 2.0 de la pestaña con un token de acceso.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-124">The provider takes the user to the tab's OAuth 2.0 redirect page with an access token.</span></span>
7. <span data-ttu-id="c6f3d-125">La pestaña comprueba que el valor devuelto coincide con lo que se guardó anteriormente y llama , que a su vez llama a la función `state` registrada en el paso `microsoftTeams.authentication.notifySuccess()` `successCallback` 3.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-125">The tab checks that the returned `state` value matches what was saved earlier, and calls `microsoftTeams.authentication.notifySuccess()`, which in turn calls the `successCallback` function registered in step 3.</span></span>
8. <span data-ttu-id="c6f3d-126">Teams cierra la ventana emergente.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-126">Teams closes the pop-up window.</span></span>
9. <span data-ttu-id="c6f3d-127">La pestaña muestra la interfaz de usuario de configuración o actualiza o vuelve a cargar el contenido de las pestañas, según desde dónde se inició el usuario.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-127">The tab either displays configuration UI or refreshes or reloads the tabs content, depending on where the user started from.</span></span>

## <a name="treat-tab-context-as-hints"></a><span data-ttu-id="c6f3d-128">Tratar el contexto de pestaña como sugerencias</span><span class="sxs-lookup"><span data-stu-id="c6f3d-128">Treat tab context as hints</span></span>

<span data-ttu-id="c6f3d-129">Aunque el contexto de la pestaña proporciona información útil sobre el usuario, no use esta información para autenticar al usuario, ya sea que la obtenga como parámetros de dirección URL a la dirección URL de contenido de la pestaña o llamando a la función en el SDK de cliente de `microsoftTeams.getContext()` Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-129">Although the tab context provides helpful information regarding the user, don't use this information to authenticate the user whether you get it as URL parameters to your tab content URL or by calling the `microsoftTeams.getContext()` function in the Microsoft Teams client SDK.</span></span> <span data-ttu-id="c6f3d-130">Un actor malintencionado podría invocar la dirección URL del contenido de la pestaña con sus propios parámetros, y una página web que suplanta Microsoft Teams podría cargar la dirección URL de contenido de la pestaña en un iframe y devolver sus propios datos a la `getContext()` función.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-130">A malicious actor could invoke your tab content URL with its own parameters, and a web page impersonating Microsoft Teams could load your tab content URL in an iframe and return its own data to the `getContext()` function.</span></span> <span data-ttu-id="c6f3d-131">Debe tratar la información relacionada con la identidad en el contexto de la pestaña simplemente como sugerencias y validarla antes de usarla.</span><span class="sxs-lookup"><span data-stu-id="c6f3d-131">You should treat the identity-related information in the tab context simply as hints and validate them before use.</span></span> <span data-ttu-id="c6f3d-132">Consulte las notas en Navegar [a la página de autorización desde la página emergente.](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page)</span><span class="sxs-lookup"><span data-stu-id="c6f3d-132">Refer to the notes in [Navigate to the authorization page from your popup page](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page).</span></span>

## <a name="samples"></a><span data-ttu-id="c6f3d-133">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="c6f3d-133">Samples</span></span>

<span data-ttu-id="c6f3d-134">Para obtener código de ejemplo que muestra el proceso de autenticación de pestañas, vea:</span><span class="sxs-lookup"><span data-stu-id="c6f3d-134">For sample code showing the tab authentication process see:</span></span>

* [<span data-ttu-id="c6f3d-135">Ejemplo de autenticación de pestañas de Microsoft Teams (Nodo)</span><span class="sxs-lookup"><span data-stu-id="c6f3d-135">Microsoft Teams tab authentication sample (Node)</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-complete-node)
* [<span data-ttu-id="c6f3d-136">Ejemplo de autenticación de pestañas de Microsoft Teams (C#)</span><span class="sxs-lookup"><span data-stu-id="c6f3d-136">Microsoft Teams tab authentication sample (C#)</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp)

## <a name="more-details"></a><span data-ttu-id="c6f3d-137">Más detalles</span><span class="sxs-lookup"><span data-stu-id="c6f3d-137">More details</span></span>

<span data-ttu-id="c6f3d-138">Para obtener un tutorial de implementación detallado para la autenticación de pestañas destinada a Azure Active Directory, vea:</span><span class="sxs-lookup"><span data-stu-id="c6f3d-138">For a detailed implementation walkthrough for tab authentication targeting Azure Active Directory see:</span></span>

* [<span data-ttu-id="c6f3d-139">Autenticar a un usuario en una pestaña de Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="c6f3d-139">Authenticate a user in a Microsoft Teams tab</span></span>](~/tabs/how-to/authentication/auth-tab-AAD.md)
* [<span data-ttu-id="c6f3d-140">Autenticación silenciosa</span><span class="sxs-lookup"><span data-stu-id="c6f3d-140">Silent authentication</span></span>](~/tabs/how-to/authentication/auth-silent-AAD.md)
