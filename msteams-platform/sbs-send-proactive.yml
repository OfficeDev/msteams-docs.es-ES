### YamlMime:Tutorial
title: Enviar mensajes proactivos
metadata:
  title: Enviar mensajes proactivos
  description: En este artículo, aprenderá a enviar mensajes proactivos, como mensajes de bienvenida, mensajes programados y notificaciones desde un bot.
  audience: Developer
  level: Beginner
  ms.date: 06/23/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: ./bots/how-to/conversations/send-proactive-messages.md
  nextTutorialTitle: Obtenga más información sobre los mensajes proactivos.
  ms.custom: mvc
  ms.localizationpriority: high
  ms.openlocfilehash: 9c763e584bcd574c2fc511000f6470d7608e3ac0
  ms.sourcegitcommit: b72f51377f41be18ee9b70b042f736605f755cf1
  ms.translationtype: MT
  ms.contentlocale: es-ES
  ms.lasthandoff: 10/21/2022
  ms.locfileid: "68670264"
items:
- durationInMinutes: 1
  content: "Un mensaje proactivo es cualquier mensaje enviado por un bot que no responde a una solicitud de un usuario que incluye mensajes, como:\n - Mensajes de bienvenida\n - Notificaciones\n - Mensajes programados\n \nEsta guía paso a paso le ayuda a enviar un mensaje proactivo desde un bot. Verá las siguientes salidas:\n\n* Mensaje de hola proactivo en el chat.  \n\n  :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-helo1.png\" alt-text=\"Mensaje de hola proactivo\":::\n\n* Mensaje de hola proactivo como tarjeta adaptable.\n\n  :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-helo-in-adaptive-card.png\" alt-text=\"Mensaje de hello proactivo en la tarjeta adaptable\"::: \n"
- title: Requisitos previos
  durationInMinutes: 2
  content: "Asegúrese de instalar lo siguiente:    \n\n| &nbsp; | Instalar | Para usar... |\n | --- | --- | --- |\n | **Required** | &nbsp; | &nbsp; |\n | &nbsp; | [Visual Studio 2022, versión 17.3](https://visualstudio.microsoft.com)<br> Instale una de las dos cargas de trabajo siguientes:<br> • desarrollo web y ASP.NET <br> • Desarrollo multiplataforma de .NET Core | Puede instalar la versión de empresa en Visual Studio 2022 e instalar las cargas de trabajo. |\n | &nbsp; | [ngrok](https://ngrok.com/download) | Las características de aplicaciones de Teams (bots conversacionales, extensiones de mensajes y webhooks entrantes) requieren conexiones entrantes. Un túnel conecta el sistema de desarrollo a Teams. No es necesario para las aplicaciones que solo incluyen pestañas. Este paquete se instala en el directorio del proyecto (mediante npm `devDependencies`). |\n | &nbsp; | [Cuenta de desarrollador de Microsoft 365](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) | Acceso a la cuenta de Teams con los permisos adecuados para instalar una aplicación. |\n | &nbsp; | [Portal para desarrolladores de Teams](https://dev.teams.microsoft.com/) | Portal basado en web para configurar, administrar y distribuir la aplicación de Teams, incluida su organización o la tienda de Teams. |\n"
- title: Configuración del entorno local
  durationInMinutes: 3
  content: "1.  Descargue el [código de ejemplo](https://github.com/MicrosoftDocs/msteams-docs/tree/master/msteams-platform/assets/downloads/SendProactiveMessages.zip) (archivo Zip) y extraiga los archivos.\n1.  Vaya a los archivos extraídos y haga doble clic en **ProactiveBot.csproj**. La solución se abre en Visual Studio.\n1.  En Visual Studio, haga clic con el botón derecho en el proyecto (**ProactiveBot**) y seleccione **Compilar** para compilar la solución.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactivebot-project1.png\" alt-text=\"Proyecto de bot proactivo\":::\n\n    <br>\n\n    <details>\n\n    <summary><b>Solución de problemas</b></summary>\n\n    Si recibe el error **No se puede encontrar el paquete** , siga estos pasos:\n\n    1.  Vaya a **Herramientas** > **Configuración del Administrador** >  de **paquetes** NuGet.\n    1.  En la ventana **Opciones** que aparece, seleccione **Orígenes de paquetes** del Administrador  >  de **paquetes NuGet**.\n    1.  Seleccione **Agregar**.\n    1.  Escriba `nuget.org` en el **nombre** y `https://api.nuget.org/v3/index.json` en los campos **Origen** .\n    1.  Seleccione **Actualizar** y **Aceptar**.\n    1.  Recompile el proyecto.\n    <br>\n\n    </details>\n    \n1. Descomprima para instalar ngrok.\n   * Windows: haga doble clic en `ngrok.zip`.\n   * Linux o OS X: descomprima ngrok desde el terminal y ejecute el `unzip /path/to/ngrok.zip` comando .\n1. Use ngrok para crear un túnel para los puntos de conexión HTTPS disponibles públicamente del servidor web en ejecución local. Ejecute el siguiente comando en ngrok:\n\n    ```bash\n    ngrok http --host-header=localhost 3978\n    ```\n    \n1. En ngrok, copie la dirección URL HTTPS. \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/ngrok-base-url1.png\" alt-text=\"dirección URL base de ngrok.\"lightbox=\"~/assets/images/proactive-scenario/ngrok-base-url1.png\":::   \n"
- title: Habilitar la versión preliminar para desarrolladores
  durationInMinutes: 1
  content: >
    1. Habilite la carga de aplicaciones en la consola de administración del inquilino.
        1. Inicie sesión en el [centro de administración de Microsoft 365](https://admin.microsoft.com/Adminportal/Home?source=applauncher#/homepage#/) con sus credenciales de administrador.
        1. En el panel izquierdo, seleccione **Mostrar todo**.
        1. Seleccione **Teams**.

           :::image type="content" source="./assets/images/meeting-token-generator/meeting-token-generator-admincenter_1.png" alt-text="Menú del Centro de administración" border="true":::
- title: Creación e instalación de una aplicación de Teams
  durationInMinutes: 5
  content: "1. Abra [el Portal para desarrolladores para Teams](https://dev.teams.microsoft.com).\n\n   Aparece la página siguiente:\n\n   :::image type=\"content\" source=\"~/assets/images/proactive-scenario/developer-portal-intro.png\" alt-text=\"Introducción al Portal para desarrolladores\":::\n\n1. Seleccione **Aplicación****de importación de aplicaciones** > .\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/upload-app-package.png\" alt-text=\"Seleccionar y cargar paquete\":::  \n\n1. Seleccione **AppManifest** y seleccione **Abrir**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-app-package.png\" alt-text=\"Seleccionar paquete de aplicación\":::\n\n1. Seleccione **Importar**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-import.png\" alt-text=\"Seleccione Importar.\":::\n\n    Aparece la página siguiente:\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-message.png\" alt-text=\"Mensaje proactivo.\"lightbox=\"~/assets/images/proactive-scenario/proactive-message.png\"::: \n\n1. Seleccione **App Features Bot (Bot** **de características** >  de la aplicación).\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-app-features.png\" alt-text=\"Seleccionar características de la aplicación\":::\n\n1. Seleccione **Crear un nuevo bot**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-bot.png\" alt-text=\"Seleccionar bot\":::     \n    \n1. Seleccione **Nuevo bot**. \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/create-new-bot.png\" alt-text=\"Creación de un nuevo bot\":::\n\n    Aparece **la ventana Agregar bot** .\n\n1. Escriba **Bot de mensaje proactivo** y seleccione **Agregar**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/enter-proactive-message.png\" alt-text=\"Escribir mensaje proactivo\":::\n\n    Ahora el bot de mensaje proactivo del bot se agrega correctamente a la aplicación. Puede ver el **nombre del bot** y el **identificador del bot**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/bot-name.png\" alt-text=\"Nombre e identificador del bot\":::\n\n   > [!TIP]\n   > Guarde el **identificador del bot** para futuras referencias.\n\n1. Haga doble clic en el **bot de mensajes proactivos**.\n\n   Aparece **la página De demostración proactiva de mensajes** .\n\n1. Seleccione **Configurar** y establezca la **dirección del punto de conexión** en forma de `https://your ngrok/api/messages`.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-configure.png\" alt-text=\"Seleccione Configurar.\":::\n\n1. Seleccione **Secretos** >  de **cliente Agregar un secreto de cliente para el bot**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/secret.png\" alt-text=\"Seleccionar secreto\":::\n\n1. Aparecerá la ventana **Nuevo secreto de cliente generado** y seleccione **Aceptar**.    \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/new-secret.png\" alt-text=\"Nuevo secreto\":::\n\n    > [!TIP]\n    > Guarde el valor **Nuevo secreto de cliente** para futuras referencias.\n\n1. Seleccione el icono Aplicaciones :::image type=\"icon\" source=\"~/assets/images/proactive-scenario/apps-icon.png\"::: y seleccione **Demo de mensajes proactivo**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-apps.png\" alt-text=\"Seleccionar aplicaciones\":::\n\n    Aparece la página siguiente:\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/overview-page.png\" alt-text=\"Página Información general\":::\n\n1. Seleccione **Características de la aplicación** en **Configurar** y seleccione **Bot**.\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-app-features1.png\" alt-text=\"Seleccionar características de la aplicación\":::\n\n1. Seleccione **Bot de mensaje proactivo** en la lista desplegable **Seleccionar un bot existente** .\n\n     :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-send-proactive-message.png\" alt-text=\"Seleccionar enviar mensajes proactivos\":::\n\n1. Seleccione **Guardar personal** > .\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-personal.png\" alt-text=\"Seleccionar personal\":::\n\n1. Abra el archivo **appsettings.json** en Visual Studio y actualice la siguiente información:\n\n    * Establezca **MicrosoftAppID** en el identificador del bot.\n    * Establezca **MicrosoftAppPassword** en el valor de id. de secreto de cliente.\n\n   :::image type=\"content\" source=\"~/assets/images/proactive-scenario/appsettings.png\" alt-text=\"Archivo de configuración de la aplicación\":::\n\n1. Seleccione **Depurar** > **Iniciar depuración**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/debug.png\" alt-text=\"Seleccione Depurar.\":::\n\n   Aparece el ejemplo de mensaje proactivo correspondiente:\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-confirm.png\" alt-text=\"Confirmación proactiva\":::\n\n1. Volver al Portal para desarrolladores, seleccione **Versión preliminar en Teams**.\n    \n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/preview-teams.png\" alt-text=\"Versión preliminar de Teams\":::\n\n1. Seleccione **Agregar**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-add.png\" alt-text=\"Seleccione Agregar.\":::\n\n   Aparece la página siguiente.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/teams-open1.png\" alt-text=\"Teams Open\":::\n\n   Abra el explorador.\n\n1. Copie y pegue la dirección URL en el `http://localhost:3978/api/notify` explorador para obtener un mensaje de hola proactivo en el chat.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/url-paste.png\" alt-text=\"Pegar url\":::\n\n1. Vaya a Teams. Recibe un mensaje de saludo proactivo del bot cuando la instalación se realiza correctamente.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-reply.png\" alt-text=\"Respuesta proactiva\":::\n"
- title: Agregar tarjeta adaptable a un mensaje proactivo
  durationInMinutes: 10
  content: "1. En Visual Studio, detenga el proceso de depuración.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/stop-debugging.png\" alt-text=\"Detener depuración\":::\n\n1. Haga clic con el botón derecho en **Dependencias** y seleccione **Administrar paquetes NuGet**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/dependencies.png\" alt-text=\"Dependencias proactivas\":::\n\n1. En **NuGet ProactiveBot**, seleccione **Examinar** y busque **AdaptiveCards**. \n1. Seleccione **Instalar**. \n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-adaptive cards.png\" alt-text=\"seleccionar tarjetas adaptables\":::\n\n1. En **la ventana Vista previa de cambios** , seleccione **Aceptar**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-ok.png\" alt-text=\"seleccione Aceptar\":::\n\n1. Abra el archivo **NotifyController.cs** en **Controladores**.\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/select-notify.png\" alt-text=\"Seleccione Notificar.\":::\n\n1. Reemplace el código existente `BotCallback` por el código siguiente para enviar el mensaje de tarjeta adaptable:     \n    \n   ```csharp\n   private async Task BotCallback(ITurnContext turnContext, CancellationToken cancellationToken)\n    {\n                AdaptiveCard card = new AdaptiveCard(new AdaptiveSchemaVersion(1, 0));\n\n                card.Body.Add(new AdaptiveTextBlock()\n                {\n                    Text = \"Proactive Hello\",\n                    Size = AdaptiveTextSize.ExtraLarge\n                });\n\n                card.Body.Add(new AdaptiveImage()\n                {\n                    Url = new Uri(\"http://adaptivecards.io/content/cats/1.png\")\n                });\n\n                Attachment attachment = new Attachment()\n                {\n                    ContentType = AdaptiveCard.ContentType,\n                    Content = card\n                };\n\n                await turnContext.SendActivityAsync(MessageFactory.Attachment(attachment));\n    }\n   ```  \n\n1. Presione **F5** para que se ejecute el código.\n\n   Aparece el ejemplo de mensaje proactivo correspondiente:\n\n    :::image type=\"content\" source=\"~/assets/images/proactive-scenario/proactive-confirm.png\" alt-text=\"Confirmación proactiva\":::\n\n1. Vaya a Teams y desinstale la aplicación. \n\n1. Vuelva a instalar la misma aplicación para obtener el `conversationUpdate` evento.   \n\n1. Copie y pegue la dirección URL en el `http://localhost:3978/api/notify` explorador para obtener un mensaje de hola proactivo en la tarjeta adaptable.     \n"
- title: Desafío completo
  durationInMinutes: 3
  content: >
    ¿Se te ocurrió algo como esto? Así es como aparece el mensaje de hola proactivo en la tarjeta adaptable:


    :::image type="content" source="~/assets/images/proactive-scenario/proactive-helo-in-adaptive-card.png" alt-text="Mensaje de hello proactivo en la tarjeta adaptable":::
- content: >-
    Ha completado el escenario.

    * Puede enviar notificaciones diariamente o solicitar comentarios del usuario periódicamente.

    * Controle los límites de limitación para evitar varias notificaciones.
