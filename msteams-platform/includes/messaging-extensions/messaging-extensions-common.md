## <a name="add-a-messaging-extension-to-your-app"></a><span data-ttu-id="d5edf-101">Agregar una extensión de mensajería a la aplicación</span><span class="sxs-lookup"><span data-stu-id="d5edf-101">Add a messaging extension to your app</span></span>

<span data-ttu-id="d5edf-102">Una extensión de mensajería es un servicio hospedado en la nube que escucha las solicitudes de los usuarios y responde con datos estructurados, como una [tarjeta.](~/task-modules-and-cards/what-are-cards.md)</span><span class="sxs-lookup"><span data-stu-id="d5edf-102">A messaging extension is a cloud-hosted service that listens to user requests and responds with structured data, such as a [card](~/task-modules-and-cards/what-are-cards.md).</span></span> <span data-ttu-id="d5edf-103">Integre el servicio con Microsoft Teams a través de objetos de Bot `Activity` Framework.</span><span class="sxs-lookup"><span data-stu-id="d5edf-103">You integrate your service with Microsoft Teams via Bot Framework `Activity` objects.</span></span> <span data-ttu-id="d5edf-104">Nuestras extensiones .NET y Node.js para el SDK de Bot Builder pueden ayudarte a agregar funcionalidad de extensión de mensajería a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5edf-104">Our .NET and Node.js extensions for the Bot Builder SDK can help you add messaging extension functionality to your app.</span></span>

![Diagrama de flujo de mensajes para extensiones de mensajería](~/assets/images/compose-extensions/ceflow.png)

### <a name="register-in-the-bot-framework"></a><span data-ttu-id="d5edf-106">Registrarse en bot framework</span><span class="sxs-lookup"><span data-stu-id="d5edf-106">Register in the Bot Framework</span></span>

<span data-ttu-id="d5edf-107">Si aún no lo ha hecho, primero debe registrar un bot con el Microsoft Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="d5edf-107">If you haven’t done so already, you must first register a bot with the Microsoft Bot Framework.</span></span> <span data-ttu-id="d5edf-108">Los puntos de conexión de id. de aplicación y de devolución de llamada de Microsoft para el bot, tal como se definen allí, se usarán en la extensión de mensajería para recibir y responder a las solicitudes de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="d5edf-108">The Microsoft app ID and callback endpoints for your bot, as defined there, will be used in your messaging extension to receive and respond to user requests.</span></span> <span data-ttu-id="d5edf-109">Recuerde habilitar el canal Microsoft Teams para el bot.</span><span class="sxs-lookup"><span data-stu-id="d5edf-109">Remember to enable the Microsoft Teams channel for your bot.</span></span>

<span data-ttu-id="d5edf-110">Registra el id. de la aplicación bot y la contraseña de la aplicación, deberás proporcionar el identificador de la aplicación en el manifiesto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5edf-110">Record your bot app ID and app password, you will need to supply the app ID in your app manifest.</span></span>

### <a name="update-your-app-manifest"></a><span data-ttu-id="d5edf-111">Actualizar el manifiesto de la aplicación</span><span class="sxs-lookup"><span data-stu-id="d5edf-111">Update your app manifest</span></span>

<span data-ttu-id="d5edf-112">Al igual que con los bots y las pestañas, actualizas el [manifiesto](~/resources/schema/manifest-schema.md#composeextensions) de la aplicación para incluir las propiedades de extensión de mensajería.</span><span class="sxs-lookup"><span data-stu-id="d5edf-112">As with bots and tabs, you update the [manifest](~/resources/schema/manifest-schema.md#composeextensions) of your app to include the messaging extension properties.</span></span> <span data-ttu-id="d5edf-113">Estas propiedades rigen cómo aparece y se comporta la extensión de mensajería en el Microsoft Teams cliente.</span><span class="sxs-lookup"><span data-stu-id="d5edf-113">These properties govern how your messaging extension appears and behaves in the Microsoft Teams client.</span></span> <span data-ttu-id="d5edf-114">Las extensiones de mensajería se admiten a partir de la versión 1.0 del manifiesto.</span><span class="sxs-lookup"><span data-stu-id="d5edf-114">Messaging extensions are supported beginning with v1.0 of the manifest.</span></span>

#### <a name="declare-your-messaging-extension"></a><span data-ttu-id="d5edf-115">Declarar la extensión de mensajería</span><span class="sxs-lookup"><span data-stu-id="d5edf-115">Declare your messaging extension</span></span>

<span data-ttu-id="d5edf-116">Para agregar una extensión de mensajería, incluya una nueva estructura JSON de nivel superior en el manifiesto con la `composeExtensions` propiedad.</span><span class="sxs-lookup"><span data-stu-id="d5edf-116">To add a messaging extension, include a new top-level JSON structure in your manifest with the `composeExtensions` property.</span></span> <span data-ttu-id="d5edf-117">Actualmente, estás limitado a crear una sola extensión de mensajería para tu aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5edf-117">Currently, you are limited to creating a single messaging extension for your app.</span></span>

> [!NOTE]
> <span data-ttu-id="d5edf-118">El manifiesto hace referencia a las extensiones de mensajería como `composeExtensions` .</span><span class="sxs-lookup"><span data-stu-id="d5edf-118">The manifest refers to messaging extensions as `composeExtensions`.</span></span> <span data-ttu-id="d5edf-119">Esto es para mantener la compatibilidad con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="d5edf-119">This is to maintain backward compatibility.</span></span>

<span data-ttu-id="d5edf-120">La definición de extensión es un objeto que tiene la siguiente estructura:</span><span class="sxs-lookup"><span data-stu-id="d5edf-120">The extension definition is an object that has the following structure:</span></span>

| <span data-ttu-id="d5edf-121">Nombre de propiedad</span><span class="sxs-lookup"><span data-stu-id="d5edf-121">Property name</span></span> | <span data-ttu-id="d5edf-122">Objetivo</span><span class="sxs-lookup"><span data-stu-id="d5edf-122">Purpose</span></span> | <span data-ttu-id="d5edf-123">¿Necesario?</span><span class="sxs-lookup"><span data-stu-id="d5edf-123">Required?</span></span> |
|---|---|---|
| `botId` | <span data-ttu-id="d5edf-124">El ID. de aplicación de Microsoft único para el bot, registrado con Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="d5edf-124">The unique Microsoft app ID for the bot as registered with the Bot Framework.</span></span> <span data-ttu-id="d5edf-125">Normalmente, debería ser el mismo que el identificador de la aplicación Teams general.</span><span class="sxs-lookup"><span data-stu-id="d5edf-125">This should typically be the same as the ID for your overall Teams app.</span></span> | <span data-ttu-id="d5edf-126">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-126">Yes</span></span> |
| `scopes` | <span data-ttu-id="d5edf-127">Matriz que declara si esta extensión se puede agregar a `personal` o `team` ámbitos (o ambos).</span><span class="sxs-lookup"><span data-stu-id="d5edf-127">Array declaring whether this extension can be added to `personal` or `team` scopes (or both).</span></span> | <span data-ttu-id="d5edf-128">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-128">Yes</span></span> |
| `canUpdateConfiguration` | <span data-ttu-id="d5edf-129">Habilita **Configuración** elemento de menú.</span><span class="sxs-lookup"><span data-stu-id="d5edf-129">Enables **Settings** menu item.</span></span> | <span data-ttu-id="d5edf-130">No</span><span class="sxs-lookup"><span data-stu-id="d5edf-130">No</span></span> |
| `commands` | <span data-ttu-id="d5edf-131">Matriz de comandos compatibles con esta extensión de mensajería.</span><span class="sxs-lookup"><span data-stu-id="d5edf-131">Array of commands that this messaging extension supports.</span></span> <span data-ttu-id="d5edf-132">Está limitado a 10 comandos.</span><span class="sxs-lookup"><span data-stu-id="d5edf-132">You are limited to 10 commands.</span></span> | <span data-ttu-id="d5edf-133">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-133">Yes</span></span> |

#### <a name="define-commands"></a><span data-ttu-id="d5edf-134">Definir comandos</span><span class="sxs-lookup"><span data-stu-id="d5edf-134">Define commands</span></span>

<span data-ttu-id="d5edf-135">La extensión de mensajería debe declarar un comando, que aparece cuando el usuario selecciona la aplicación en el botón Más **opciones** (**&#8943;**) en el cuadro de redacción.</span><span class="sxs-lookup"><span data-stu-id="d5edf-135">Your messaging extension should declare one command, which appears when the user selects your app from the **More options** (**&#8943;**) button in the compose box.</span></span>

![Captura de pantalla de la lista de extensiones de mensajería en Teams](~/assets/images/compose-extensions/compose-extension-list.png)

<span data-ttu-id="d5edf-137">En el manifiesto de la aplicación, el elemento de comando es un objeto con la siguiente estructura:</span><span class="sxs-lookup"><span data-stu-id="d5edf-137">In the app manifest, your command item is an object with the following structure:</span></span>

| <span data-ttu-id="d5edf-138">Nombre de propiedad</span><span class="sxs-lookup"><span data-stu-id="d5edf-138">Property name</span></span> | <span data-ttu-id="d5edf-139">Objetivo</span><span class="sxs-lookup"><span data-stu-id="d5edf-139">Purpose</span></span> | <span data-ttu-id="d5edf-140">¿Necesario?</span><span class="sxs-lookup"><span data-stu-id="d5edf-140">Required?</span></span> | <span data-ttu-id="d5edf-141">Versión mínima del manifiesto</span><span class="sxs-lookup"><span data-stu-id="d5edf-141">Minimum manifest version</span></span> |
|---|---|---|---|
| `id` | <span data-ttu-id="d5edf-142">Identificador único que se asigna a este comando.</span><span class="sxs-lookup"><span data-stu-id="d5edf-142">Unique ID that you assign to this command.</span></span> <span data-ttu-id="d5edf-143">La solicitud de usuario incluirá este identificador.</span><span class="sxs-lookup"><span data-stu-id="d5edf-143">The user request will include this ID.</span></span> | <span data-ttu-id="d5edf-144">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-144">Yes</span></span> | <span data-ttu-id="d5edf-145">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-145">1.0</span></span> |
| `title` | <span data-ttu-id="d5edf-146">Nombre del comando.</span><span class="sxs-lookup"><span data-stu-id="d5edf-146">Command name.</span></span> <span data-ttu-id="d5edf-147">Este valor aparece en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="d5edf-147">This value appears in the UI.</span></span> | <span data-ttu-id="d5edf-148">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-148">Yes</span></span> | <span data-ttu-id="d5edf-149">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-149">1.0</span></span> |
| `description` | <span data-ttu-id="d5edf-150">Texto de ayuda que indica lo que hace este comando.</span><span class="sxs-lookup"><span data-stu-id="d5edf-150">Help text indicating what this command does.</span></span> <span data-ttu-id="d5edf-151">Este valor aparece en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="d5edf-151">This value appears in the UI.</span></span> | <span data-ttu-id="d5edf-152">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-152">Yes</span></span> | <span data-ttu-id="d5edf-153">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-153">1.0</span></span> |
| `type` | <span data-ttu-id="d5edf-154">Establezca el tipo de comando.</span><span class="sxs-lookup"><span data-stu-id="d5edf-154">Set the type of command.</span></span> <span data-ttu-id="d5edf-155">Los valores posibles incluyen `query` y `action`.</span><span class="sxs-lookup"><span data-stu-id="d5edf-155">Possible values include `query` and `action`.</span></span> <span data-ttu-id="d5edf-156">Si no está presente, el valor predeterminado se establece en `query` .</span><span class="sxs-lookup"><span data-stu-id="d5edf-156">If not present the default value is set to `query`.</span></span> | <span data-ttu-id="d5edf-157">No</span><span class="sxs-lookup"><span data-stu-id="d5edf-157">No</span></span> | <span data-ttu-id="d5edf-158">1.4</span><span class="sxs-lookup"><span data-stu-id="d5edf-158">1.4</span></span> |
| `initialRun` | <span data-ttu-id="d5edf-159">Parámetro opcional, usado con `query` comandos.</span><span class="sxs-lookup"><span data-stu-id="d5edf-159">Optional parameter, used with `query` commands.</span></span> <span data-ttu-id="d5edf-160">Si se establece en **true,** indica que este comando debe ejecutarse tan pronto como el usuario elija este comando en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="d5edf-160">If set to **true**, indicates this command should be executed as soon as the user chooses this command in the UI.</span></span> | <span data-ttu-id="d5edf-161">No</span><span class="sxs-lookup"><span data-stu-id="d5edf-161">No</span></span> | <span data-ttu-id="d5edf-162">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-162">1.0</span></span> |
| `fetchTask` | <span data-ttu-id="d5edf-163">Parámetro opcional, usado con `action` comandos.</span><span class="sxs-lookup"><span data-stu-id="d5edf-163">Optional parameter, used with `action` commands.</span></span> <span data-ttu-id="d5edf-164">Se establece **en true** para capturar la tarjeta adaptable o la dirección URL web que se va a mostrar en el módulo [de tareas](~/task-modules-and-cards/what-are-task-modules.md).</span><span class="sxs-lookup"><span data-stu-id="d5edf-164">Set to **true** to fetch the adaptive card or web url to display within the [task module](~/task-modules-and-cards/what-are-task-modules.md).</span></span> <span data-ttu-id="d5edf-165">Esto se usa cuando las entradas al comando son dinámicas en lugar de `action` un conjunto estático de parámetros.</span><span class="sxs-lookup"><span data-stu-id="d5edf-165">This is used when the inputs to the `action` command is dynamic as opposed to a static set of parameters.</span></span> <span data-ttu-id="d5edf-166">Tenga en cuenta que si se establece en **true,** se omite la lista de parámetros estáticos del comando.</span><span class="sxs-lookup"><span data-stu-id="d5edf-166">Note that the if set to **true** the static parameter list for the command is ignored.</span></span> | <span data-ttu-id="d5edf-167">No</span><span class="sxs-lookup"><span data-stu-id="d5edf-167">No</span></span> | <span data-ttu-id="d5edf-168">1.4</span><span class="sxs-lookup"><span data-stu-id="d5edf-168">1.4</span></span> |
| `parameters` | <span data-ttu-id="d5edf-169">Lista estática de parámetros para el comando.</span><span class="sxs-lookup"><span data-stu-id="d5edf-169">Static list of parameters for the command.</span></span> | <span data-ttu-id="d5edf-170">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-170">Yes</span></span> | <span data-ttu-id="d5edf-171">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-171">1.0</span></span> |
| `parameter.name` | <span data-ttu-id="d5edf-172">Nombre del parámetro.</span><span class="sxs-lookup"><span data-stu-id="d5edf-172">The name of the parameter.</span></span> <span data-ttu-id="d5edf-173">Esto se envía al servicio en la solicitud de usuario.</span><span class="sxs-lookup"><span data-stu-id="d5edf-173">This is sent to your service in the user request.</span></span> | <span data-ttu-id="d5edf-174">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-174">Yes</span></span> | <span data-ttu-id="d5edf-175">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-175">1.0</span></span> |
| `parameter.description` | <span data-ttu-id="d5edf-176">Describe los propósitos de este parámetro o un ejemplo del valor que se debe proporcionar.</span><span class="sxs-lookup"><span data-stu-id="d5edf-176">Describes this parameter’s purposes or example of the value that should be provided.</span></span> <span data-ttu-id="d5edf-177">Este valor aparece en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="d5edf-177">This value appears in the UI.</span></span> | <span data-ttu-id="d5edf-178">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-178">Yes</span></span> | <span data-ttu-id="d5edf-179">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-179">1.0</span></span> |
| `parameter.title` | <span data-ttu-id="d5edf-180">Título o etiqueta de parámetros fáciles de usar cortos.</span><span class="sxs-lookup"><span data-stu-id="d5edf-180">Short user-friendly parameter title or label.</span></span> | <span data-ttu-id="d5edf-181">Sí</span><span class="sxs-lookup"><span data-stu-id="d5edf-181">Yes</span></span> | <span data-ttu-id="d5edf-182">1.0</span><span class="sxs-lookup"><span data-stu-id="d5edf-182">1.0</span></span> |
| `parameter.inputType` | <span data-ttu-id="d5edf-183">Se establece en el tipo de entrada necesario.</span><span class="sxs-lookup"><span data-stu-id="d5edf-183">Set to the type of input required.</span></span> <span data-ttu-id="d5edf-184">Los valores posibles `text` incluyen , , , , , `textarea` `number` `date` `time` `toggle` .</span><span class="sxs-lookup"><span data-stu-id="d5edf-184">Possible values include `text`, `textarea`, `number`, `date`, `time`, `toggle`.</span></span> <span data-ttu-id="d5edf-185">El valor predeterminado se establece en `text` .</span><span class="sxs-lookup"><span data-stu-id="d5edf-185">Default is set to `text`.</span></span> | <span data-ttu-id="d5edf-186">No</span><span class="sxs-lookup"><span data-stu-id="d5edf-186">No</span></span> | <span data-ttu-id="d5edf-187">1.4</span><span class="sxs-lookup"><span data-stu-id="d5edf-187">1.4</span></span> |
| `context` | <span data-ttu-id="d5edf-188">Matriz opcional de valores que define el contexto en el que está disponible la acción del mensaje.</span><span class="sxs-lookup"><span data-stu-id="d5edf-188">Optional array of values that defines the context the message action is available in.</span></span> <span data-ttu-id="d5edf-189">Los valores posibles `message` `compose` son , o `commandBox` .</span><span class="sxs-lookup"><span data-stu-id="d5edf-189">Possible values are `message`, `compose`, or `commandBox`.</span></span> <span data-ttu-id="d5edf-190">El valor predeterminado es `["compose", "commandBox"]`.</span><span class="sxs-lookup"><span data-stu-id="d5edf-190">Default is `["compose", "commandBox"]`.</span></span> | <span data-ttu-id="d5edf-191">No</span><span class="sxs-lookup"><span data-stu-id="d5edf-191">No</span></span> | <span data-ttu-id="d5edf-192">1,5</span><span class="sxs-lookup"><span data-stu-id="d5edf-192">1.5</span></span> |
