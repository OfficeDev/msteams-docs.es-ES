---
title: Cambios en la API de bot para los miembros del equipo o chat
author: ojasvichoudhary
description: Describe los próximos cambios en curso de las API de bot usadas para recuperar miembros de equipos y chats
keywords: Lista de miembros del equipo de apis de bot framework
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: ee90c9c324f11e191cf596bcf8e27cd2bef41240
ms.sourcegitcommit: f5ee3fa5ef6126d9bf845948d27d9067b3bbb994
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2021
ms.locfileid: "51596185"
---
# <a name="changes-to-teams-bot-apis-for-fetching-team-and-chat-members"></a><span data-ttu-id="9cf36-104">Cambios en las API de bots de Teams para capturar miembros de equipo y chat</span><span class="sxs-lookup"><span data-stu-id="9cf36-104">Changes to Teams bot APIs for fetching team and chat members</span></span>

>[!NOTE]
> <span data-ttu-id="9cf36-105">Hemos empezado con el proceso de desuso para `TeamsInfo.getMembers` las API y las `TeamsInfo.GetMembersAsync` API.</span><span class="sxs-lookup"><span data-stu-id="9cf36-105">We've started with the deprecation process for `TeamsInfo.getMembers` and `TeamsInfo.GetMembersAsync` APIs.</span></span> <span data-ttu-id="9cf36-106">Inicialmente, se limitarán en gran medida a 5 solicitudes por minuto y devolverán un máximo de 10.000 miembros por equipo.</span><span class="sxs-lookup"><span data-stu-id="9cf36-106">Initially, they will be heavily throttled to 5 requests per minute and return a maximum of 10K members per team.</span></span> <span data-ttu-id="9cf36-107">Esto hará que no se devuelva la lista completa a medida que aumente el tamaño del equipo.</span><span class="sxs-lookup"><span data-stu-id="9cf36-107">This will result in the full roster not being returned as team size increases.</span></span> 
> 
> <span data-ttu-id="9cf36-108">**Debe actualizar a la versión 4.10** o posterior del SDK de Bot Framework y cambiar a los extremos de api paginados o a la `TeamsInfo.GetMemberAsync` API de usuario único.</span><span class="sxs-lookup"><span data-stu-id="9cf36-108">**You must update to version 4.10 or higher of the Bot Framework SDK** and switch to the paginated API endpoints, or the `TeamsInfo.GetMemberAsync` single user API.</span></span> <span data-ttu-id="9cf36-109">Esto también se aplica al bot incluso si no estás usando directamente estas API, ya que los SDK antiguos llaman a estas API durante [los eventos membersAdded.](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added)</span><span class="sxs-lookup"><span data-stu-id="9cf36-109">This also applies to your bot even if you're not directly using these APIs, as older SDKs call these APIs during [membersAdded](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) events.</span></span> <span data-ttu-id="9cf36-110">Para ver la lista de próximos cambios, vea [Cambios de la API](team-chat-member-api-changes.md#api-changes).</span><span class="sxs-lookup"><span data-stu-id="9cf36-110">To view the list of upcoming changes, see [API changes](team-chat-member-api-changes.md#api-changes).</span></span> 

<span data-ttu-id="9cf36-111">Actualmente, los desarrolladores de bots que desean recuperar información para uno o varios miembros de un chat o equipo usan las API de bots de Microsoft Teams `TeamsInfo.GetMembersAsync` (para C#) o `TeamsInfo.getMembers` (para TypeScript/Node.js) [(documentadas aquí).](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile)</span><span class="sxs-lookup"><span data-stu-id="9cf36-111">Currently, bot developers who want to retrieve information for one or more members of a chat or team use the Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` (for C#) or `TeamsInfo.getMembers` (for TypeScript/Node.js) APIs [(documented here)](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile).</span></span> <span data-ttu-id="9cf36-112">Estas API tienen varios defectos en la actualidad:</span><span class="sxs-lookup"><span data-stu-id="9cf36-112">These APIs have several shortcomings today:</span></span>

* <span data-ttu-id="9cf36-113">**Para equipos grandes, el rendimiento es bajo y los tiempos de espera son más probables.**</span><span class="sxs-lookup"><span data-stu-id="9cf36-113">**For large teams, performance is poor and timeouts are more likely.**</span></span> <span data-ttu-id="9cf36-114">El tamaño máximo del equipo ha aumentado considerablemente desde que Microsoft Teams se lanzó a principios de 2017.</span><span class="sxs-lookup"><span data-stu-id="9cf36-114">The maximum team size has grown considerably since Microsoft Teams was released in early 2017.</span></span> <span data-ttu-id="9cf36-115">Dado que devuelve toda la lista de miembros, la llamada a la API tarda mucho tiempo en volver para equipos grandes, y no es raro que la llamada se desalome y tenga que intentarlo de `GetMembersAsync` / `getMembers` nuevo.</span><span class="sxs-lookup"><span data-stu-id="9cf36-115">Since `GetMembersAsync`/`getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it’s not uncommon for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="9cf36-116">**Obtener detalles de perfil para un solo usuario es engorroso.**</span><span class="sxs-lookup"><span data-stu-id="9cf36-116">**Getting profile details for a single user is cumbersome.**</span></span> <span data-ttu-id="9cf36-117">Para obtener la información de perfil de un solo usuario, debe recuperar toda la lista de miembros y, a continuación, buscar el que desee.</span><span class="sxs-lookup"><span data-stu-id="9cf36-117">To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="9cf36-118">True, hay una función auxiliar en el SDK de Bot Framework para que sea más sencilla, pero bajo las cubiertas no es eficaz.</span><span class="sxs-lookup"><span data-stu-id="9cf36-118">True, there’s a helper function in the Bot Framework SDK to make it simpler, but under the covers it’s not efficient.</span></span>

<span data-ttu-id="9cf36-119">Por separado, con la introducción de equipos de toda la organización, nos dimos cuenta de que era el momento de alinear mejor estas API con los controles de privacidad de Office 365: los bots usados en equipos grandes pueden recuperar información básica de perfil, que es similar al permiso de `User.ReadBasic.All` Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="9cf36-119">Separately, with the introduction of org-wide teams, we realized it was time to better align these APIs with Office 365 privacy controls: bots used in large teams are able to retrieve basic profile information, which is similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="9cf36-120">Los administradores de inquilinos tienen un gran control sobre qué aplicaciones y bots se pueden usar en su inquilino, pero esta configuración es diferente de las que rigen Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="9cf36-120">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different than the ones governing Microsoft Graph.</span></span>

<span data-ttu-id="9cf36-121">Esta es una representación JSON de ejemplo de lo que devuelven estas API hoy en día.</span><span class="sxs-lookup"><span data-stu-id="9cf36-121">Here’s a sample JSON representation of what’s returned by these APIs today.</span></span> <span data-ttu-id="9cf36-122">Me referiré a algunos de los campos siguientes.</span><span class="sxs-lookup"><span data-stu-id="9cf36-122">I’ll refer to some of the fields below.</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "name": "Anon1 (Guest)",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "anonymous"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}]
```

## <a name="api-changes"></a><span data-ttu-id="9cf36-123">Cambios en la API</span><span class="sxs-lookup"><span data-stu-id="9cf36-123">API changes</span></span>

<span data-ttu-id="9cf36-124">Estos son los próximos cambios en la API:</span><span class="sxs-lookup"><span data-stu-id="9cf36-124">Here are the upcoming API changes:</span></span>

* <span data-ttu-id="9cf36-125">Hemos creado una nueva API para recuperar información [`TeamsInfo.GetPagedMembersAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#fetching-the-roster-or-user-profile) de perfil para los miembros de un chat o equipo.</span><span class="sxs-lookup"><span data-stu-id="9cf36-125">We've created a new API [`TeamsInfo.GetPagedMembersAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#fetching-the-roster-or-user-profile) for retrieving profile information for members of a chat/team.</span></span> <span data-ttu-id="9cf36-126">Esta API ya está disponible con el SDK de Bot Framework 4.10.</span><span class="sxs-lookup"><span data-stu-id="9cf36-126">This API is now available with the Bot Framework 4.10 SDK.</span></span> <span data-ttu-id="9cf36-127">Para el desarrollo en todas las demás versiones, use el [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) método.</span><span class="sxs-lookup"><span data-stu-id="9cf36-127">For development in all other versions use the [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) method.</span></span>
  > [!NOTE]
  > <span data-ttu-id="9cf36-128">En v3 o v4, la mejor acción es actualizar a la versión de punto más reciente.</span><span class="sxs-lookup"><span data-stu-id="9cf36-128">In either v3 or v4, the best action is to upgrade to the latest point release.</span></span>
* <span data-ttu-id="9cf36-129">Hemos creado una nueva API para [`TeamsInfo.GetMemberAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#get-single-member-details) recuperar la información de perfil de un solo usuario.</span><span class="sxs-lookup"><span data-stu-id="9cf36-129">We've created a new API [`TeamsInfo.GetMemberAsync`](~/bots/how-to/get-teams-context.md?tabs=dotnet#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="9cf36-130">Toma el identificador del equipo/chat y un [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) ( , vea más arriba ), El identificador de objeto de Azure Active Directory ( , vea más arriba ) o el id. de usuario de Teams ( , vea más arriba ) como parámetros y devuelve la información de perfil para ese `userPrincipalName`  `objectId`  `id` usuario. </span><span class="sxs-lookup"><span data-stu-id="9cf36-130">It takes the ID of the team/chat and a [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) (`userPrincipalName`, *see above*), Azure Active Directory Object ID (`objectId`, *see above*), or the Teams user ID (`id`, *see above*) as parameters and returns the profile information for that user.</span></span>
  > [!NOTE]
  > <span data-ttu-id="9cf36-131">Estamos cambiando a para que coincida con lo que se `objectId` llama en el objeto de un mensaje de Bot `aadObjectId` `Activity` Framework.</span><span class="sxs-lookup"><span data-stu-id="9cf36-131">We're changing `objectId` to `aadObjectId` to match what it's called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="9cf36-132">La nueva API está disponible con la versión 4.10 del SDK de Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="9cf36-132">The new API is available with version 4.10 of the Bot Framework SDK.</span></span> <span data-ttu-id="9cf36-133">Pronto estará disponible en la extensión del SDK de Teams Bot Framework 3.x también; mientras tanto, puede usar el extremo [REST.](~/bots/how-to/get-teams-context.md?tabs=json#get-single-member-details)</span><span class="sxs-lookup"><span data-stu-id="9cf36-133">It will soon be available in the Teams SDK extension Bot Framework 3.x as well; meanwhile you can use the [REST](~/bots/how-to/get-teams-context.md?tabs=json#get-single-member-details) endpoint.</span></span>
* <span data-ttu-id="9cf36-134">`TeamsInfo.GetMembersAsync` (C#) y (TypeScript/Node.js) están formalmente en desuso y dejarán de funcionar a finales de `TeamsInfo.getMembers` 2021.</span><span class="sxs-lookup"><span data-stu-id="9cf36-134">`TeamsInfo.GetMembersAsync` (C#) and `TeamsInfo.getMembers` (TypeScript/Node.js) is formally deprecated and will stop working in late 2021.</span></span> <span data-ttu-id="9cf36-135">Actualice los bots para usar las API paginadas.</span><span class="sxs-lookup"><span data-stu-id="9cf36-135">Please update your bots to use the paged APIs.</span></span> <span data-ttu-id="9cf36-136">(Esto también se aplica a la [API de REST subyacente que usan estas API](~/bots/how-to/get-teams-context.md?tabs=json)).)</span><span class="sxs-lookup"><span data-stu-id="9cf36-136">(This also applies to the [underlying REST API these APIs use](~/bots/how-to/get-teams-context.md?tabs=json).)</span></span>
* <span data-ttu-id="9cf36-137">A finales de 2021, los bots no podrán recuperar proactivamente las propiedades or de los miembros de un chat o equipo y tendrán que usar Microsoft Graph para `userPrincipalName` `email` recuperarlas.</span><span class="sxs-lookup"><span data-stu-id="9cf36-137">By late 2021, bots will not be able to proactively retrieve the `userPrincipalName` or `email` properties for members of a chat/team and will need to use Microsoft Graph to retrieve them.</span></span> <span data-ttu-id="9cf36-138">En concreto, las propiedades no se devolverán desde la nueva API a `userPrincipalName` partir de `email` `GetConversationPagedMembers` finales de 2021.</span><span class="sxs-lookup"><span data-stu-id="9cf36-138">Specifically, `userPrincipalName` and `email` properties won't be returned from the new `GetConversationPagedMembers` API starting in late 2021.</span></span> <span data-ttu-id="9cf36-139">Los bots tendrán que usar Microsoft Graph con un token de acceso para recuperar esta información.</span><span class="sxs-lookup"><span data-stu-id="9cf36-139">Bots will have to use Microsoft Graph with an access token to retrieve this information.</span></span> <span data-ttu-id="9cf36-140">Obviamente, este es un cambio importante: debemos facilitar que los bots obtengan un token de acceso y debemos simplificar y simplificar el proceso de consentimiento del usuario final.</span><span class="sxs-lookup"><span data-stu-id="9cf36-140">This is obviously a major change: We must make it easier for bots to get an access token, and we must streamline and simplify the end-user consent process.</span></span>

## <a name="feedback-and-more-information"></a><span data-ttu-id="9cf36-141">Comentarios y más información</span><span class="sxs-lookup"><span data-stu-id="9cf36-141">Feedback and more information</span></span>

<span data-ttu-id="9cf36-142">Usaremos esta página para proporcionar información actualizada sobre estos cambios.</span><span class="sxs-lookup"><span data-stu-id="9cf36-142">We'll use this page for providing up to date information on these changes.</span></span> <span data-ttu-id="9cf36-143">Si tiene preguntas, use la sección "Enviar comentarios > en esta página" en la **sección Comentarios** que aparece a continuación.</span><span class="sxs-lookup"><span data-stu-id="9cf36-143">If you have questions, use the "Send feedback > on this page" in the **Feedback** section below.</span></span>
