---
title: Cambios en la API de bot para miembros de equipo o chat (actualización de 2020)
author: ojasvichoudhary
description: Describe los cambios futuros y en curso de las API de bot que se usan para recuperar miembros de equipos y chats
keywords: API de bots Framework lista de miembros del equipo
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: 926e4e39e4b5c3f1ba34a4458cf6f17612d86841
ms.sourcegitcommit: b13b38a104946c32cd5245a7af706070e534927d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/28/2020
ms.locfileid: "44801478"
---
# <a name="changes-to-teams-bot-apis-for-fetching-teamchat-members"></a><span data-ttu-id="38c67-104">Cambios en las API de bot de Teams para obtener miembros de equipo o chat</span><span class="sxs-lookup"><span data-stu-id="38c67-104">Changes to Teams Bot APIs for Fetching Team/Chat Members</span></span>

<span data-ttu-id="38c67-105">Actualmente, los desarrolladores de bot que quieren recuperar información de uno o varios miembros de un chat o equipo usan las API de bot de Microsoft Teams `TeamsInfo.GetMembersAsync` (para C#) o `TeamsInfo.getMembers` (para TypeScript/Node.js) API (se [documenta aquí)](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile).</span><span class="sxs-lookup"><span data-stu-id="38c67-105">Currently, bot developers who want to retrieve information for one or more members of a chat or team use the Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` (for C#) or `TeamsInfo.getMembers` (for TypeScript/Node.js) APIs [(documented here)](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile).</span></span> <span data-ttu-id="38c67-106">Estas API presentan varias deficiencias en la actualidad:</span><span class="sxs-lookup"><span data-stu-id="38c67-106">These APIs have several shortcomings today:</span></span>

* <span data-ttu-id="38c67-107">**Para los equipos grandes, el rendimiento es deficiente y los tiempos de espera son más probables.**</span><span class="sxs-lookup"><span data-stu-id="38c67-107">**For large teams, performance is poor and timeouts are more likely.**</span></span> <span data-ttu-id="38c67-108">El tamaño máximo del equipo ha crecido considerablemente desde la publicación de Microsoft Teams a principios del 2017.</span><span class="sxs-lookup"><span data-stu-id="38c67-108">The maximum team size has grown considerably since Microsoft Teams was released in early 2017.</span></span> <span data-ttu-id="38c67-109">Dado que `GetMembersAsync` / `getMembers` devuelve la lista completa de miembros, la llamada a la API tarda mucho tiempo en devolverse a los equipos grandes, por lo que no es raro que se agote el tiempo de espera y tiene que intentarlo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="38c67-109">Since `GetMembersAsync`/`getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it’s not uncommon for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="38c67-110">**La obtención de detalles de perfil para un solo usuario es engorroso.**</span><span class="sxs-lookup"><span data-stu-id="38c67-110">**Getting profile details for a single user is cumbersome.**</span></span> <span data-ttu-id="38c67-111">Para obtener la información de Perfil de un único usuario, tiene que recuperar la lista completa de miembros y, a continuación, buscar la que desee.</span><span class="sxs-lookup"><span data-stu-id="38c67-111">To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="38c67-112">True, hay una función auxiliar en el SDK de bot Framework para que sea más sencilla, pero en el caso de que no sea eficiente.</span><span class="sxs-lookup"><span data-stu-id="38c67-112">True, there’s a helper function in the Bot Framework SDK to make it simpler, but under the covers it’s not efficient.</span></span>

<span data-ttu-id="38c67-113">Por separado, con la introducción de los equipos de toda la organización, nos dimos cuenta de que se trataba de tiempo para alinear mejor estas API con los controles de privacidad de Office 365: los bots que se usan en los equipos grandes pueden recuperar información básica del perfil, que es similar al `User.ReadBasic.All` permiso de Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="38c67-113">Separately, with the introduction of org-wide teams, we realized it was time to better align these APIs with Office 365 privacy controls: bots used in large teams are able to retrieve basic profile information, which is similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="38c67-114">Los administradores de espacios empresariales tienen una gran cantidad de control sobre qué aplicaciones y bots se pueden usar en su inquilino, pero estas opciones son diferentes de las que se rigen en Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="38c67-114">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different than the ones governing Microsoft Graph.</span></span>

<span data-ttu-id="38c67-115">Aquí tiene una representación JSON de ejemplo de lo que estas API devuelven actualmente.</span><span class="sxs-lookup"><span data-stu-id="38c67-115">Here’s a sample JSON representation of what’s returned by these APIs today.</span></span> <span data-ttu-id="38c67-116">Haré referencia a algunos de los campos siguientes.</span><span class="sxs-lookup"><span data-stu-id="38c67-116">I’ll refer to some of the fields below.</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "objectId": "9d3e08f9-a7ae-43aa-a4d3-de3f319a8a9c",
    "givenName": "Larry",
    "surname": "Brown",
    "email": "Larry.Brown@fabrikam.com",
    "userPrincipalName": "labrown@fabrikam.com"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com"
}]
```

## <a name="api-changes"></a><span data-ttu-id="38c67-117">Cambios en la API</span><span class="sxs-lookup"><span data-stu-id="38c67-117">API Changes</span></span>
<span data-ttu-id="38c67-118">Estos son los próximos cambios en la API:</span><span class="sxs-lookup"><span data-stu-id="38c67-118">Here are the upcoming API changes:</span></span>

* <span data-ttu-id="38c67-119">Hemos creado una nueva API [`TeamsInfo.GetPagedMembersAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile) para recuperar la información de Perfil de los miembros de un equipo o chat.</span><span class="sxs-lookup"><span data-stu-id="38c67-119">We've created a new API [`TeamsInfo.GetPagedMembersAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetching-the-roster-or-user-profile) for retrieving profile information for members of a chat/team.</span></span> <span data-ttu-id="38c67-120">Esta API ahora está disponible con bot Framework 4,8 SDK.</span><span class="sxs-lookup"><span data-stu-id="38c67-120">This API is now available with the Bot Framework 4.8 SDK.</span></span> <span data-ttu-id="38c67-121">Para el desarrollo en todas las demás versiones, use el [`GetConversationPagedMembers`](https://docs.microsoft.com/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable) método.</span><span class="sxs-lookup"><span data-stu-id="38c67-121">For development in all other versions use the [`GetConversationPagedMembers`](https://docs.microsoft.com/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable) method.</span></span> <span data-ttu-id="38c67-122">**Nota**: en V3 o V4, la mejor acción es actualizar a la versión más reciente del punto (3.30.2 o 4,8 respectivamente).</span><span class="sxs-lookup"><span data-stu-id="38c67-122">**Note**: In either v3 or v4, the best action is to upgrade to the latest point release (3.30.2 or 4.8 respectively).</span></span> 
* <span data-ttu-id="38c67-123">Hemos creado una nueva API [`TeamsInfo.GetMemberAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) para recuperar la información de Perfil de un solo usuario.</span><span class="sxs-lookup"><span data-stu-id="38c67-123">We've created a new API [`TeamsInfo.GetMemberAsync`](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="38c67-124">Toma el identificador del equipo/chat y un [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) ( `userPrincipalName` , *vea más arriba*), el identificador de objeto de Azure Active Directory ( `objectId` , *vea más arriba*) o el identificador de usuario de Teams ( `id` , *vea lo anterior*) como parámetros y devuelve la información de Perfil de ese usuario.</span><span class="sxs-lookup"><span data-stu-id="38c67-124">It takes the ID of the team/chat and a [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) (`userPrincipalName`, *see above*), Azure Active Directory Object ID (`objectId`, *see above*), or the Teams user ID (`id`, *see above*) as parameters and returns the profile information for that user.</span></span> <span data-ttu-id="38c67-125">**Nota**: estamos cambiando `objectId` a `aadObjectId` para que concuerda con lo que se llama en el `Activity` objeto de un mensaje de marco de bot.</span><span class="sxs-lookup"><span data-stu-id="38c67-125">**Note**: We're changing `objectId` to `aadObjectId` to match what it's called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="38c67-126">La nueva API está disponible con la versión 4,8 del SDK de bot Framework.</span><span class="sxs-lookup"><span data-stu-id="38c67-126">The new API is available with version 4.8 of the Bot Framework SDK.</span></span> <span data-ttu-id="38c67-127">Pronto estará disponible en el marco de bot extensiones de Team SDK, versión 3. x, y mientras tanto, puede usar el punto de conexión de [Rest](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details) .</span><span class="sxs-lookup"><span data-stu-id="38c67-127">It will soon be available in the Teams SDK extension Bot Framework 3.x as well; meanwhile you can use the [REST](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details) endpoint.</span></span>
* <span data-ttu-id="38c67-128">`TeamsInfo.GetMembersAsync`(C#) y `TeamsInfo.getMembers` (TypeScript/Node.js) se ha dejado de usar formalmente y dejará de funcionar a finales de 2021.</span><span class="sxs-lookup"><span data-stu-id="38c67-128">`TeamsInfo.GetMembersAsync` (C#) and `TeamsInfo.getMembers` (TypeScript/Node.js) is formally deprecated and will stop working in late 2021.</span></span> <span data-ttu-id="38c67-129">Anunciaremos un calendario específico en mayo de 2020, en función de los comentarios de los desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="38c67-129">We'll announce a specific timetable in May 2020, based on feedback from developers.</span></span> <span data-ttu-id="38c67-130">Una vez que la nueva API paginada esté disponible, los desarrolladores deben actualizar sus bots para usarla.</span><span class="sxs-lookup"><span data-stu-id="38c67-130">Once the new paged API is available, developers should update their bots to use it.</span></span> <span data-ttu-id="38c67-131">(Esto también se aplica a la [API de REST subyacente que usan estas API](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json)).</span><span class="sxs-lookup"><span data-stu-id="38c67-131">(This also applies to the [underlying REST API these APIs use](https://docs.microsoft.com/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json).)</span></span>
* <span data-ttu-id="38c67-132">Con posterioridad a 2021, los bots no podrán recuperar de forma proactiva `userPrincipalName` las `email` propiedades o de los miembros de un chat o equipo, y deberán usar Microsoft Graph para recuperarlas.</span><span class="sxs-lookup"><span data-stu-id="38c67-132">By late 2021, bots will not be able to proactively retrieve the `userPrincipalName` or `email` properties for members of a chat/team and will need to use Microsoft Graph to retrieve them.</span></span> <span data-ttu-id="38c67-133">En concreto `userPrincipalName` , `email` no se devolverán las propiedades de la nueva `GetConversationPagedMembers` API a partir del 2021 posterior.</span><span class="sxs-lookup"><span data-stu-id="38c67-133">Specifically, `userPrincipalName` and `email` properties won't be returned from the new `GetConversationPagedMembers` API starting in late 2021.</span></span> <span data-ttu-id="38c67-134">Los bots tendrán que usar Microsoft Graph con un token de acceso para recuperar esta información.</span><span class="sxs-lookup"><span data-stu-id="38c67-134">Bots will have to use Microsoft Graph with an access token to retrieve this information.</span></span> <span data-ttu-id="38c67-135">Obviamente esto es un cambio importante: debemos facilitar a los bots la tarea de obtener un token de acceso, y debemos racionalizar y simplificar el proceso de consentimiento del usuario final.</span><span class="sxs-lookup"><span data-stu-id="38c67-135">This is obviously a major change: We must make it easier for bots to get an access token, and we must streamline and simplify the end-user consent process.</span></span>

## <a name="feedback-and-more-information"></a><span data-ttu-id="38c67-136">Comentarios y más información</span><span class="sxs-lookup"><span data-stu-id="38c67-136">Feedback and More Information</span></span>
<span data-ttu-id="38c67-137">Usaremos esta página para ofrecer información actualizada sobre estos cambios.</span><span class="sxs-lookup"><span data-stu-id="38c67-137">We'll use this page for providing up to date information on these changes.</span></span> <span data-ttu-id="38c67-138">Si tiene alguna pregunta, use "enviar comentarios > en esta p? gina" en la sección **comentarios** a continuación.</span><span class="sxs-lookup"><span data-stu-id="38c67-138">If you have questions, use the "Send feedback > on this page" in the **Feedback** section below.</span></span> 
