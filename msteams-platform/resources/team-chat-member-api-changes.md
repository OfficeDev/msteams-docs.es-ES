---
title: Cambios en la API de bot para los miembros del equipo o chat
author: ojasvichoudhary
description: Describe los cambios próximos y en curso en las API de Bot utilizadas para recuperar miembros de equipos y chats
keywords: lista de miembros del equipo de apis de bot framework
localization_priority: Normal
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: 333a29664f0d60e89039f906fce77e71054d486f
ms.sourcegitcommit: 9ef3b415cbba484c2201abe9c6927e08d974388e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/19/2021
ms.locfileid: "52555440"
---
# <a name="teams-bot-api-changes-to-fetch-team-or-chat-members"></a><span data-ttu-id="52fc0-104">Teams cambios en la API de bots para obtener miembros del equipo o del chat</span><span class="sxs-lookup"><span data-stu-id="52fc0-104">Teams bot API changes to fetch team or chat members</span></span>

>[!NOTE]
> <span data-ttu-id="52fc0-105">Se ha iniciado el proceso de desuso `TeamsInfo.getMembers` y `TeamsInfo.GetMembersAsync` las API.</span><span class="sxs-lookup"><span data-stu-id="52fc0-105">The deprecation process for `TeamsInfo.getMembers` and `TeamsInfo.GetMembersAsync` APIs have started.</span></span> <span data-ttu-id="52fc0-106">Inicialmente, están fuertemente limitados a cinco solicitudes por minuto y devuelven un máximo de 10K miembros por equipo.</span><span class="sxs-lookup"><span data-stu-id="52fc0-106">Initially, they are heavily throttled to five requests per minute and return a maximum of 10K members per team.</span></span> <span data-ttu-id="52fc0-107">Esto hace que la lista completa no se devuelva a medida que aumenta el tamaño del equipo.</span><span class="sxs-lookup"><span data-stu-id="52fc0-107">This results in the full roster not being returned as team size increases.</span></span>
> <span data-ttu-id="52fc0-108">Debe actualizar a la versión 4.10 o superior del SDK de Bot Framework y cambiar a los puntos de conexión de API paginados o a la API de `TeamsInfo.GetMemberAsync` usuario único.</span><span class="sxs-lookup"><span data-stu-id="52fc0-108">You must update to version 4.10 or higher of the Bot Framework SDK and switch to the paginated API endpoints, or the `TeamsInfo.GetMemberAsync` single user API.</span></span> <span data-ttu-id="52fc0-109">Esto también se aplica al bot incluso si no está utilizando directamente estas API, ya que los SDK anteriores llaman a estas API durante los eventos [membersAdded.](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added)</span><span class="sxs-lookup"><span data-stu-id="52fc0-109">This also applies to your bot even if you are not directly using these APIs, as older SDKs call these APIs during [membersAdded](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) events.</span></span> <span data-ttu-id="52fc0-110">Para ver la lista de los próximos cambios, consulte [Cambios en la API.](team-chat-member-api-changes.md#api-changes)</span><span class="sxs-lookup"><span data-stu-id="52fc0-110">To view the list of upcoming changes, see [API changes](team-chat-member-api-changes.md#api-changes).</span></span> 

<span data-ttu-id="52fc0-111">Actualmente, los desarrolladores de bots que desean recuperar información para uno o varios miembros de un chat o equipo usan las API de bot de Microsoft Teams `TeamsInfo.GetMembersAsync` para C# o `TeamsInfo.getMembers` para TypeScript o Node.js API.</span><span class="sxs-lookup"><span data-stu-id="52fc0-111">Currently, bot developers who want to retrieve information for one or more members of a chat or team use the Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` for C# or `TeamsInfo.getMembers` for TypeScript or Node.js APIs.</span></span> <span data-ttu-id="52fc0-112">Para obtener más información, consulte [fetch roster o user profile](../bots/how-to/get-teams-context.md#fetch-the-roster-or-user-profile).</span><span class="sxs-lookup"><span data-stu-id="52fc0-112">For more information, see [fetch roster or user profile](../bots/how-to/get-teams-context.md#fetch-the-roster-or-user-profile).</span></span> <span data-ttu-id="52fc0-113">Estas API tienen varias deficiencias.</span><span class="sxs-lookup"><span data-stu-id="52fc0-113">These APIs have several shortcomings.</span></span>

<span data-ttu-id="52fc0-114">Actualmente, si desea recuperar información para uno o varios miembros de un chat o equipo, puede usar las [API de bot de Microsoft Teams](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) para `TeamsInfo.GetMembersAsync` C# o para Las API de `TeamsInfo.getMembers` TypeScript o Node.js.</span><span class="sxs-lookup"><span data-stu-id="52fc0-114">Currently, if you want to retrieve information for one or more members of a chat or team, you can use the [Microsoft Teams bot APIs](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) `TeamsInfo.GetMembersAsync` for C# or `TeamsInfo.getMembers` for TypeScript or Node.js APIs.</span></span> <span data-ttu-id="52fc0-115">Estas API tienen las siguientes deficiencias:</span><span class="sxs-lookup"><span data-stu-id="52fc0-115">These APIs have the following shortcomings:</span></span>

* <span data-ttu-id="52fc0-116">Para los equipos grandes, el rendimiento es pobre y los tiempos de espera son más probables: el tamaño máximo del equipo ha crecido considerablemente desde que Teams fue lanzado a principios de 2017.</span><span class="sxs-lookup"><span data-stu-id="52fc0-116">For large teams, performance is poor and timeouts are more likely: The maximum team size has grown considerably since Teams was released in early 2017.</span></span> <span data-ttu-id="52fc0-117">Como `GetMembersAsync` o devuelve toda la lista de `getMembers` miembros, la llamada a la API tarda mucho tiempo en devolverse para equipos grandes, y es común que la llamada agote el tiempo de espera y tenga que intentarlo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="52fc0-117">As `GetMembersAsync` or `getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it is common for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="52fc0-118">Obtener detalles de perfil para un solo usuario es difícil: para obtener la información de perfil de un solo usuario, debe recuperar toda la lista de miembros y, a continuación, buscar la que desee.</span><span class="sxs-lookup"><span data-stu-id="52fc0-118">Getting profile details for a single user is difficult: To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="52fc0-119">Hay una función auxiliar en el SDK de Bot Framework para que sea más sencilla, pero no es eficaz.</span><span class="sxs-lookup"><span data-stu-id="52fc0-119">There is a helper function in the Bot Framework SDK to make it simpler, but it is not efficient.</span></span>

<span data-ttu-id="52fc0-120">Con la introducción de equipos de toda la organización, es necesario alinear mejor estas API con Office 365 controles de privacidad.</span><span class="sxs-lookup"><span data-stu-id="52fc0-120">With the introduction of organization wide teams, there is a requirement to better align these APIs with Office 365 privacy controls.</span></span> <span data-ttu-id="52fc0-121">Los bots utilizados en equipos grandes pueden recuperar información básica del perfil similar al `User.ReadBasic.All` permiso de Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="52fc0-121">Bots used in large teams are able to retrieve basic profile information similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="52fc0-122">Los administradores de inquilinos tienen un gran control sobre qué aplicaciones y bots se pueden usar en su inquilino, pero esta configuración es diferente de Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="52fc0-122">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different from Microsoft Graph.</span></span>

<span data-ttu-id="52fc0-123">El código siguiente proporciona una representación JSON de ejemplo de lo que devuelven las API de bot de Teams:</span><span class="sxs-lookup"><span data-stu-id="52fc0-123">The following code provides a sample JSON representation of what is returned by Teams bot APIs:</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "name": "Anon1 (Guest)",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "anonymous"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}]
```

## <a name="api-changes"></a><span data-ttu-id="52fc0-124">Cambios en la API</span><span class="sxs-lookup"><span data-stu-id="52fc0-124">API Changes</span></span>

<span data-ttu-id="52fc0-125">A continuación se presentan los próximos cambios en la API:</span><span class="sxs-lookup"><span data-stu-id="52fc0-125">Following are the upcoming API changes:</span></span>

* <span data-ttu-id="52fc0-126">Se crea una nueva API [`TeamsInfo.GetPagedMembersAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) para recuperar información de perfil para los miembros de un chat o equipo.</span><span class="sxs-lookup"><span data-stu-id="52fc0-126">A new API is created [`TeamsInfo.GetPagedMembersAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) for retrieving profile information for members of a chat or team.</span></span> <span data-ttu-id="52fc0-127">Esta API ya está disponible con bot framework versión 4.8 o posterior SDK.</span><span class="sxs-lookup"><span data-stu-id="52fc0-127">This API is now available with the Bot Framework version 4.8 or later SDK.</span></span> <span data-ttu-id="52fc0-128">Para el desarrollo en todas las demás versiones, utilice el [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) método.</span><span class="sxs-lookup"><span data-stu-id="52fc0-128">For development in all other versions, use the [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) method.</span></span>

    > [!NOTE]
    > <span data-ttu-id="52fc0-129">En v3 o v4, la mejor acción es actualizar a la última versión de puntos que es 3.30.2 o 4.8 o posterior respectivamente.</span><span class="sxs-lookup"><span data-stu-id="52fc0-129">In either v3 or v4, the best action is to upgrade to the latest point release that is 3.30.2 or 4.8 or later respectively.</span></span>

* <span data-ttu-id="52fc0-130">Se crea una nueva API [`TeamsInfo.GetMemberAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) para recuperar la información de perfil de un solo usuario.</span><span class="sxs-lookup"><span data-stu-id="52fc0-130">A new API is created [`TeamsInfo.GetMemberAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="52fc0-131">Toma el ID del equipo o chat y un [UPN](/windows/win32/ad/naming-properties#userprincipalname) que `userPrincipalName` es, Azure Active Directory Id. de objeto, o el ID de `objectId` usuario Teams como parámetros y devuelve la información de perfil de ese `id` usuario.</span><span class="sxs-lookup"><span data-stu-id="52fc0-131">It takes the ID of the team or chat and a [UPN](/windows/win32/ad/naming-properties#userprincipalname) that is `userPrincipalName`, Azure Active Directory Object ID `objectId`, or the Teams user ID `id` as parameters and returns the profile information for that user.</span></span>

    > [!NOTE]
    > <span data-ttu-id="52fc0-132">`objectId` se cambia `aadObjectId` para que coincida con lo que se llama en el objeto de un mensaje de Bot `Activity` Framework.</span><span class="sxs-lookup"><span data-stu-id="52fc0-132">`objectId` is changed to `aadObjectId` to match what is called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="52fc0-133">La nueva API está disponible con la versión 4.8 o posterior del SDK de Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="52fc0-133">The new API is available with version 4.8 or later of the Bot Framework SDK.</span></span> <span data-ttu-id="52fc0-134">También está disponible en la extensión Teams SDK Bot Framework 3.x.</span><span class="sxs-lookup"><span data-stu-id="52fc0-134">It is also available in the Teams SDK extension Bot Framework 3.x.</span></span> <span data-ttu-id="52fc0-135">Mientras tanto, puede usar el punto de conexión [REST.](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details)</span><span class="sxs-lookup"><span data-stu-id="52fc0-135">Meanwhile, you can use the [REST](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details) endpoint.</span></span>

* <span data-ttu-id="52fc0-136">`TeamsInfo.GetMembersAsync` en C# y `TeamsInfo.getMembers` en TypeScript o Node.js está formalmente en desuso.</span><span class="sxs-lookup"><span data-stu-id="52fc0-136">`TeamsInfo.GetMembersAsync` in C# and `TeamsInfo.getMembers` in TypeScript or Node.js is formally deprecated.</span></span> <span data-ttu-id="52fc0-137">Una vez que la nueva API esté disponible, debe actualizar los bots para usarlo.</span><span class="sxs-lookup"><span data-stu-id="52fc0-137">Once the new API is available, you must update your bots to use it.</span></span> <span data-ttu-id="52fc0-138">Esto también se aplica a la [API de REST subyacente que usan estas API.](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json)</span><span class="sxs-lookup"><span data-stu-id="52fc0-138">This also applies to the [underlying REST API that these APIs use](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json).</span></span>
* <span data-ttu-id="52fc0-139">A finales de 2021, los bots no pueden recuperar proactivamente las `userPrincipalName` propiedades o propiedades de los miembros de un chat o `email` equipo.</span><span class="sxs-lookup"><span data-stu-id="52fc0-139">By late 2021, bots cannot proactively retrieve the `userPrincipalName` or `email` properties for members of a chat or team.</span></span> <span data-ttu-id="52fc0-140">Los bots deben usar Graph para recuperarlos.</span><span class="sxs-lookup"><span data-stu-id="52fc0-140">Bots must use Graph to retrieve them.</span></span> <span data-ttu-id="52fc0-141">La `userPrincipalName` `email` nueva API no se devuelve desde la nueva API a partir de finales de `GetConversationPagedMembers` 2021.</span><span class="sxs-lookup"><span data-stu-id="52fc0-141">The `userPrincipalName` and `email` properties are not returned from the new `GetConversationPagedMembers` API starting in late 2021.</span></span> <span data-ttu-id="52fc0-142">Los bots tienen que usar Graph con un token de acceso para recuperar información.</span><span class="sxs-lookup"><span data-stu-id="52fc0-142">Bots have to use Graph with an access token to retrieve information.</span></span> <span data-ttu-id="52fc0-143">Debe facilitarse a los bots obtener un token de acceso y optimizar y simplificar el proceso de consentimiento del usuario final.</span><span class="sxs-lookup"><span data-stu-id="52fc0-143">It must be made easier for bots to get an access token and streamline and simplify the end-user consent process.</span></span>
